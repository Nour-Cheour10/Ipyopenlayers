var Qe=class{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}};var Ct=Qe;var Mi={PROPERTYCHANGE:"propertychange"};var Je=class{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}},Ii=Je;function ce(i,t){return i>t?1:i<t?-1:0}function Wt(i,t,e){if(i[0]<=t)return 0;let n=i.length;if(t<=i[n-1])return n-1;if(typeof e=="function"){for(let r=1;r<n;++r){let o=i[r];if(o===t)return r;if(o<t)return e(t,i[r-1],o)>0?r-1:r}return n-1}if(e>0){for(let r=1;r<n;++r)if(i[r]<t)return r-1;return n-1}if(e<0){for(let r=1;r<n;++r)if(i[r]<=t)return r;return n-1}for(let r=1;r<n;++r){if(i[r]==t)return r;if(i[r]<t)return i[r-1]-t<t-i[r]?r-1:r}return n-1}function wi(i,t){let e=Array.isArray(t)?t:[t],n=e.length;for(let r=0;r<n;r++)i[i.length]=e[r]}function Ie(i,t){let e=i.length;if(e!==t.length)return!1;for(let n=0;n<e;n++)if(i[n]!==t[n])return!1;return!0}function vi(i,t,e){let n=t||ce;return i.every(function(r,o){if(o===0)return!0;let s=n(i[o-1],r);return!(s>0||e&&s===0)})}function he(){}function Si(i){let t=!1,e,n,r;return function(){let o=Array.prototype.slice.call(arguments);return(!t||this!==r||!Ie(o,n))&&(t=!0,r=this,n=o,e=i.apply(this,arguments)),e}}function we(i){for(let t in i)delete i[t]}function Pi(i){let t;for(t in i)return!1;return!t}var $e=class extends Ii{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;let n=this.listeners_||(this.listeners_={}),r=n[t]||(n[t]=[]);r.includes(e)||r.push(e)}dispatchEvent(t){let e=typeof t=="string",n=e?t:t.type,r=this.listeners_&&this.listeners_[n];if(!r)return;let o=e?new Ct(t):t;o.target||(o.target=this.eventTarget_||this);let s=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});n in s||(s[n]=0,a[n]=0),++s[n];let l;for(let u=0,c=r.length;u<c;++u)if("handleEvent"in r[u]?l=r[u].handleEvent(o):l=r[u].call(this,o),l===!1||o.propagationStopped){l=!1;break}if(--s[n]===0){let u=a[n];for(delete a[n];u--;)this.removeEventListener(n,he);delete s[n]}return l}disposeInternal(){this.listeners_&&we(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return this.listeners_?t?t in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(t,e){if(!this.listeners_)return;let n=this.listeners_[t];if(!n)return;let r=n.indexOf(e);r!==-1&&(this.pendingRemovals_&&t in this.pendingRemovals_?(n[r]=he,++this.pendingRemovals_[t]):(n.splice(r,1),n.length===0&&delete this.listeners_[t]))}},ve=$e;var X={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};function rt(i,t,e,n,r){if(n&&n!==i&&(e=e.bind(n)),r){let s=e;e=function(){i.removeEventListener(t,e),s.apply(this,arguments)}}let o={target:i,type:t,listener:e};return i.addEventListener(t,e),o}function Kt(i,t,e,n){return rt(i,t,e,n,!0)}function V(i){i&&i.target&&(i.target.removeEventListener(i.type,i.listener),we(i))}var qt=class extends ve{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(X.CHANGE)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){let n=t.length,r=new Array(n);for(let o=0;o<n;++o)r[o]=rt(this,t[o],e);return r}return rt(this,t,e)}onceInternal(t,e){let n;if(Array.isArray(t)){let r=t.length;n=new Array(r);for(let o=0;o<r;++o)n[o]=Kt(this,t[o],e)}else n=Kt(this,t,e);return e.ol_key=n,n}unInternal(t,e){let n=e.ol_key;if(n)bo(n);else if(Array.isArray(t))for(let r=0,o=t.length;r<o;++r)this.removeEventListener(t[r],e);else this.removeEventListener(t,e)}};qt.prototype.on;qt.prototype.once;qt.prototype.un;function bo(i){if(Array.isArray(i))for(let t=0,e=i.length;t<e;++t)V(i[t]);else V(i)}var Se=qt;function I(){throw new Error("Unimplemented abstract method.")}var Oo=0;function j(i){return i.ol_uid||(i.ol_uid=String(++Oo))}var Pe=class extends Ct{constructor(t,e,n){super(t),this.key=e,this.oldValue=n}},tn=class extends Se{constructor(t){super(),this.on,this.once,this.un,j(this),this.values_=null,t!==void 0&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,e){let n;n=`change:${t}`,this.hasListener(n)&&this.dispatchEvent(new Pe(n,t,e)),n=Mi.PROPERTYCHANGE,this.hasListener(n)&&this.dispatchEvent(new Pe(n,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,n){let r=this.values_||(this.values_={});if(n)r[t]=e;else{let o=r[t];r[t]=e,o!==e&&this.notify(t,o)}}setProperties(t,e){for(let n in t)this.set(n,t[n],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){let n=this.values_[t];delete this.values_[t],Pi(this.values_)&&(this.values_=null),e||this.notify(t,n)}}},Mt=tn;var C={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};function v(i,t){if(!i)throw new Error(t)}function P(i,t,e){return Math.min(Math.max(i,t),e)}function Ai(i,t,e,n,r,o){let s=r-e,a=o-n;if(s!==0||a!==0){let l=((i-e)*s+(t-n)*a)/(s*s+a*a);l>1?(e=r,n=o):l>0&&(e+=s*l,n+=a*l)}return ht(i,t,e,n)}function ht(i,t,e,n){let r=e-i,o=n-t;return r*r+o*o}function Fi(i){let t=i.length;for(let n=0;n<t;n++){let r=n,o=Math.abs(i[n][n]);for(let a=n+1;a<t;a++){let l=Math.abs(i[a][n]);l>o&&(o=l,r=a)}if(o===0)return null;let s=i[r];i[r]=i[n],i[n]=s;for(let a=n+1;a<t;a++){let l=-i[a][n]/i[n][n];for(let u=n;u<t+1;u++)n==u?i[a][u]=0:i[a][u]+=l*i[n][u]}}let e=new Array(t);for(let n=t-1;n>=0;n--){e[n]=i[n][t]/i[n][n];for(let r=n-1;r>=0;r--)i[r][t]-=i[r][n]*e[n]}return e}function Vt(i){return i*Math.PI/180}function ft(i,t){let e=i%t;return e*t<0?e+t:e}function bi(i,t,e){return i+e*(t-i)}function Oi(i,t){let e=Math.pow(10,t);return Math.round(i*e)/e}function fe(i,t){return Math.floor(Oi(i,t))}function ge(i,t){return Math.ceil(Oi(i,t))}var en=class extends Mt{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;let e=Object.assign({},t);typeof t.properties=="object"&&(delete e.properties,Object.assign(e,t.properties)),e[C.OPACITY]=t.opacity!==void 0?t.opacity:1,v(typeof e[C.OPACITY]=="number","Layer opacity must be a number"),e[C.VISIBLE]=t.visible!==void 0?t.visible:!0,e[C.Z_INDEX]=t.zIndex,e[C.MAX_RESOLUTION]=t.maxResolution!==void 0?t.maxResolution:1/0,e[C.MIN_RESOLUTION]=t.minResolution!==void 0?t.minResolution:0,e[C.MIN_ZOOM]=t.minZoom!==void 0?t.minZoom:-1/0,e[C.MAX_ZOOM]=t.maxZoom!==void 0?t.maxZoom:1/0,this.className_=e.className!==void 0?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){let e=this.state_||{layer:this,managed:t===void 0?!0:t},n=this.getZIndex();return e.opacity=P(Math.round(this.getOpacity()*100)/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=n===void 0&&!e.managed?1/0:n,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return I()}getLayerStatesArray(t){return I()}getExtent(){return this.get(C.EXTENT)}getMaxResolution(){return this.get(C.MAX_RESOLUTION)}getMinResolution(){return this.get(C.MIN_RESOLUTION)}getMinZoom(){return this.get(C.MIN_ZOOM)}getMaxZoom(){return this.get(C.MAX_ZOOM)}getOpacity(){return this.get(C.OPACITY)}getSourceState(){return I()}getVisible(){return this.get(C.VISIBLE)}getZIndex(){return this.get(C.Z_INDEX)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(C.EXTENT,t)}setMaxResolution(t){this.set(C.MAX_RESOLUTION,t)}setMinResolution(t){this.set(C.MIN_RESOLUTION,t)}setMaxZoom(t){this.set(C.MAX_ZOOM,t)}setMinZoom(t){this.set(C.MIN_ZOOM,t)}setOpacity(t){v(typeof t=="number","Layer opacity must be a number"),this.set(C.OPACITY,t)}setVisible(t){this.set(C.VISIBLE,t)}setZIndex(t){this.set(C.Z_INDEX,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}},Li=en;var Xt={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"};var gt={ANIMATING:0,INTERACTING:1};var B={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};var dt={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};var nn=class{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=t.extent!==void 0?t.extent:null,this.worldExtent_=t.worldExtent!==void 0?t.worldExtent:null,this.axisOrientation_=t.axisOrientation!==void 0?t.axisOrientation:"enu",this.global_=t.global!==void 0?t.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||dt[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!!(t&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!!(this.global_&&t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}},Ae=nn;var de=6378137,Bt=Math.PI*de,Lo=[-Bt,-Bt,Bt,Bt],Xo=[-180,-85,180,85],Fe=de*Math.log(Math.tan(Math.PI/2)),It=class extends Ae{constructor(t){super({code:t,units:"m",extent:Lo,global:!0,worldExtent:Xo,getPointResolution:function(e,n){return e/Math.cosh(n[1]/de)}})}},rn=[new It("EPSG:3857"),new It("EPSG:102100"),new It("EPSG:102113"),new It("EPSG:900913"),new It("http://www.opengis.net/def/crs/EPSG/0/3857"),new It("http://www.opengis.net/gml/srs/epsg.xml#3857")];function Xi(i,t,e){let n=i.length;e=e>1?e:2,t===void 0&&(e>2?t=i.slice():t=new Array(n));for(let r=0;r<n;r+=e){t[r]=Bt*i[r]/180;let o=de*Math.log(Math.tan(Math.PI*(+i[r+1]+90)/360));o>Fe?o=Fe:o<-Fe&&(o=-Fe),t[r+1]=o}return t}function Ni(i,t,e){let n=i.length;e=e>1?e:2,t===void 0&&(e>2?t=i.slice():t=new Array(n));for(let r=0;r<n;r+=e)t[r]=180*i[r]/Bt,t[r+1]=360*Math.atan(Math.exp(i[r+1]/de))/Math.PI-90;return t}var No=6378137,Di=[-180,-90,180,90],Do=Math.PI*No/180,mt=class extends Ae{constructor(t,e){super({code:t,units:"degrees",extent:Di,axisOrientation:e,global:!0,metersPerUnit:Do,worldExtent:Di})}},on=[new mt("CRS:84"),new mt("EPSG:4326","neu"),new mt("urn:ogc:def:crs:OGC:1.3:CRS84"),new mt("urn:ogc:def:crs:OGC:2:84"),new mt("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new mt("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new mt("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];var sn={};function ji(i){return sn[i]||sn[i.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function Gi(i,t){sn[i]=t}var Ht={};function me(i,t,e){let n=i.getCode(),r=t.getCode();n in Ht||(Ht[n]={}),Ht[n][r]=e}function zi(i,t){let e;return i in Ht&&t in Ht[i]&&(e=Ht[i][t]),e}var O={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function an(i){let t=H();for(let e=0,n=i.length;e<n;++e)_e(t,i[e]);return t}function jo(i,t,e){let n=Math.min.apply(null,i),r=Math.min.apply(null,t),o=Math.max.apply(null,i),s=Math.max.apply(null,t);return wt(n,r,o,s,e)}function be(i,t,e){let n,r;return t<i[0]?n=i[0]-t:i[2]<t?n=t-i[2]:n=0,e<i[1]?r=i[1]-e:i[3]<e?r=e-i[3]:r=0,n*n+r*r}function Qt(i,t){return ln(i,t[0],t[1])}function Zi(i,t){return i[0]<=t[0]&&t[2]<=i[2]&&i[1]<=t[1]&&t[3]<=i[3]}function ln(i,t,e){return i[0]<=t&&t<=i[2]&&i[1]<=e&&e<=i[3]}function Ui(i,t){let e=i[0],n=i[1],r=i[2],o=i[3],s=t[0],a=t[1],l=O.UNKNOWN;return s<e?l=l|O.LEFT:s>r&&(l=l|O.RIGHT),a<n?l=l|O.BELOW:a>o&&(l=l|O.ABOVE),l===O.UNKNOWN&&(l=O.INTERSECTING),l}function H(){return[1/0,1/0,-1/0,-1/0]}function wt(i,t,e,n,r){return r?(r[0]=i,r[1]=t,r[2]=e,r[3]=n,r):[i,t,e,n]}function pe(i){return wt(1/0,1/0,-1/0,-1/0,i)}function Yi(i,t){let e=i[0],n=i[1];return wt(e,n,e,n,t)}function ki(i,t,e,n,r){let o=pe(r);return un(o,i,t,e,n)}function Wi(i,t){return i[0]==t[0]&&i[2]==t[2]&&i[1]==t[1]&&i[3]==t[3]}function Ki(i,t){return t[0]<i[0]&&(i[0]=t[0]),t[2]>i[2]&&(i[2]=t[2]),t[1]<i[1]&&(i[1]=t[1]),t[3]>i[3]&&(i[3]=t[3]),i}function _e(i,t){t[0]<i[0]&&(i[0]=t[0]),t[0]>i[2]&&(i[2]=t[0]),t[1]<i[1]&&(i[1]=t[1]),t[1]>i[3]&&(i[3]=t[1])}function un(i,t,e,n,r){for(;e<n;e+=r)Go(i,t[e],t[e+1]);return i}function Go(i,t,e){i[0]=Math.min(i[0],t),i[1]=Math.min(i[1],e),i[2]=Math.max(i[2],t),i[3]=Math.max(i[3],e)}function Oe(i,t){let e;return e=t(Jt(i)),e||(e=t($t(i)),e)||(e=t(ee(i)),e)||(e=t(Q(i)),e)?e:!1}function xe(i){let t=0;return ne(i)||(t=A(i)*L(i)),t}function Jt(i){return[i[0],i[1]]}function $t(i){return[i[2],i[1]]}function pt(i){return[(i[0]+i[2])/2,(i[1]+i[3])/2]}function qi(i,t){let e;if(t==="bottom-left")e=Jt(i);else if(t==="bottom-right")e=$t(i);else if(t==="top-left")e=Q(i);else if(t==="top-right")e=ee(i);else throw new Error("Invalid corner");return e}function Vi(i,t,e,n,r){let[o,s,a,l,u,c,h,f]=Le(i,t,e,n);return wt(Math.min(o,a,u,h),Math.min(s,l,c,f),Math.max(o,a,u,h),Math.max(s,l,c,f),r)}function Le(i,t,e,n){let r=t*n[0]/2,o=t*n[1]/2,s=Math.cos(e),a=Math.sin(e),l=r*s,u=r*a,c=o*s,h=o*a,f=i[0],d=i[1];return[f-l+h,d-u-c,f-l-h,d-u+c,f+l-h,d+u+c,f+l+h,d+u-c,f-l+h,d-u-c]}function L(i){return i[3]-i[1]}function te(i,t,e){let n=e||H();return _t(i,t)?(i[0]>t[0]?n[0]=i[0]:n[0]=t[0],i[1]>t[1]?n[1]=i[1]:n[1]=t[1],i[2]<t[2]?n[2]=i[2]:n[2]=t[2],i[3]<t[3]?n[3]=i[3]:n[3]=t[3]):pe(n),n}function Q(i){return[i[0],i[3]]}function ee(i){return[i[2],i[3]]}function A(i){return i[2]-i[0]}function _t(i,t){return i[0]<=t[2]&&i[2]>=t[0]&&i[1]<=t[3]&&i[3]>=t[1]}function ne(i){return i[2]<i[0]||i[3]<i[1]}function Bi(i,t){return t?(t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t):i}function Hi(i,t,e){let n=!1,r=Ui(i,t),o=Ui(i,e);if(r===O.INTERSECTING||o===O.INTERSECTING)n=!0;else{let s=i[0],a=i[1],l=i[2],u=i[3],c=t[0],h=t[1],f=e[0],d=e[1],g=(d-h)/(f-c),m,p;o&O.ABOVE&&!(r&O.ABOVE)&&(m=f-(d-u)/g,n=m>=s&&m<=l),!n&&o&O.RIGHT&&!(r&O.RIGHT)&&(p=d-(f-l)*g,n=p>=a&&p<=u),!n&&o&O.BELOW&&!(r&O.BELOW)&&(m=f-(d-a)/g,n=m>=s&&m<=l),!n&&o&O.LEFT&&!(r&O.LEFT)&&(p=d-(f-s)*g,n=p>=a&&p<=u)}return n}function Qi(i,t,e,n){if(ne(i))return pe(e);let r=[];if(n>1){let a=i[2]-i[0],l=i[3]-i[1];for(let u=0;u<n;++u)r.push(i[0]+a*u/n,i[1],i[2],i[1]+l*u/n,i[2]-a*u/n,i[3],i[0],i[3]-l*u/n)}else r=[i[0],i[1],i[2],i[1],i[2],i[3],i[0],i[3]];t(r,r,2);let o=[],s=[];for(let a=0,l=r.length;a<l;a+=2)o.push(r[a]),s.push(r[a+1]);return jo(o,s,e)}function Ji(i,t){return i[0]+=+t[0],i[1]+=+t[1],i}function Nt(i,t){let e=!0;for(let n=i.length-1;n>=0;--n)if(i[n]!=t[n]){e=!1;break}return e}function $i(i,t){let e=Math.cos(t),n=Math.sin(t),r=i[0]*e-i[1]*n,o=i[1]*e+i[0]*n;return i[0]=r,i[1]=o,i}var zo=63710088e-1;function cn(i,t,e){e=e||zo;let n=Vt(i[1]),r=Vt(t[1]),o=(r-n)/2,s=Vt(t[0]-i[0])/2,a=Math.sin(o)*Math.sin(o)+Math.sin(s)*Math.sin(s)*Math.cos(n)*Math.cos(r);return 2*e*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}var tr={info:1,warn:2,error:3,none:4},Uo=tr.info;function er(...i){Uo>tr.warn||console.warn(...i)}var hn=!0;function ir(i){hn=!(i===void 0?!0:i)}function fn(i,t){if(t!==void 0){for(let e=0,n=i.length;e<n;++e)t[e]=i[e];t=t}else t=i.slice();return t}function rr(i,t){if(t!==void 0&&i!==t){for(let e=0,n=i.length;e<n;++e)t[e]=i[e];i=t}return i}function Zo(i){Gi(i.getCode(),i),me(i,i,fn)}function Yo(i){i.forEach(Zo)}function G(i){return typeof i=="string"?ji(i):i||null}function gn(i,t,e,n){i=G(i);let r,o=i.getPointResolutionFunc();if(o){if(r=o(t,e),n&&n!==i.getUnits()){let s=i.getMetersPerUnit();s&&(r=r*s/dt[n])}}else{let s=i.getUnits();if(s=="degrees"&&!n||n=="degrees")r=t;else{let a=dn(i,G("EPSG:4326"));if(a===rr&&s!=="degrees")r=t*i.getMetersPerUnit();else{let u=[e[0]-t/2,e[1],e[0]+t/2,e[1],e[0],e[1]-t/2,e[0],e[1]+t/2];u=a(u,u,2);let c=cn(u.slice(0,2),u.slice(2,4)),h=cn(u.slice(4,6),u.slice(6,8));r=(c+h)/2}let l=n?dt[n]:i.getMetersPerUnit();l!==void 0&&(r/=l)}}return r}function nr(i){Yo(i),i.forEach(function(t){i.forEach(function(e){t!==e&&me(t,e,fn)})})}function ko(i,t,e,n){i.forEach(function(r){t.forEach(function(o){me(r,o,e),me(o,r,n)})})}function Xe(i,t){return i?typeof i=="string"?G(i):i:G(t)}function vt(i,t){if(i===t)return!0;let e=i.getUnits()===t.getUnits();return(i.getCode()===t.getCode()||dn(i,t)===fn)&&e}function dn(i,t){let e=i.getCode(),n=t.getCode(),r=zi(e,n);return r||(r=rr),r}function Dt(i,t){let e=G(i),n=G(t);return dn(e,n)}function Ne(i,t,e){return Dt(t,e)(i,void 0,i.length)}function or(i,t,e,n){let r=Dt(t,e);return Qi(i,r,void 0,n)}var xt=null;function sr(){return xt}function mn(i,t){return xt?Ne(i,t,xt):i}function Rt(i,t){return xt?Ne(i,xt,t):(hn&&!Nt(i,[0,0])&&i[0]>=-180&&i[0]<=180&&i[1]>=-90&&i[1]<=90&&(hn=!1,er("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),i)}function ar(i,t){return xt?or(i,t,xt):i}function St(i,t){return xt?or(i,xt,t):i}function Wo(){nr(rn),nr(on),ko(on,rn,Xi,Ni)}Wo();function pn(i,t,e){return function(n,r,o,s,a){if(!n)return;if(!r&&!t)return n;let l=t?0:o[0]*r,u=t?0:o[1]*r,c=a?a[0]:0,h=a?a[1]:0,f=i[0]+l/2+c,d=i[2]-l/2+c,g=i[1]+u/2+h,m=i[3]-u/2+h;f>d&&(f=(d+f)/2,d=f),g>m&&(g=(m+g)/2,m=g);let p=P(n[0],f,d),x=P(n[1],g,m);if(s&&e&&r){let _=30*r;p+=-_*Math.log(1+Math.max(0,f-n[0])/_)+_*Math.log(1+Math.max(0,n[0]-d)/_),x+=-_*Math.log(1+Math.max(0,g-n[1])/_)+_*Math.log(1+Math.max(0,n[1]-m)/_)}return[p,x]}}function lr(i){return i}function _n(i,t,e,n){let r=A(t)/e[0],o=L(t)/e[1];return n?Math.min(i,Math.max(r,o)):Math.min(i,Math.min(r,o))}function xn(i,t,e){let n=Math.min(i,t),r=50;return n*=Math.log(1+r*Math.max(0,i/t-1))/r+1,e&&(n=Math.max(n,e),n/=Math.log(1+r*Math.max(0,e/i-1))/r+1),P(n,e/2,t*2)}function ur(i,t,e,n){return t=t!==void 0?t:!0,function(r,o,s,a){if(r!==void 0){let l=i[0],u=i[i.length-1],c=e?_n(l,e,s,n):l;if(a)return t?xn(r,c,u):P(r,u,c);let h=Math.min(c,r),f=Math.floor(Wt(i,h,o));return i[f]>c&&f<i.length-1?i[f+1]:i[f]}}}function cr(i,t,e,n,r,o){return n=n!==void 0?n:!0,e=e!==void 0?e:0,function(s,a,l,u){if(s!==void 0){let c=r?_n(t,r,l,o):t;if(u)return n?xn(s,c,e):P(s,e,c);let h=1e-9,f=Math.ceil(Math.log(t/c)/Math.log(i)-h),d=-a*(.5-h)+.5,g=Math.min(c,s),m=Math.floor(Math.log(t/g)/Math.log(i)+d),p=Math.max(f,m),x=t/Math.pow(i,p);return P(x,e,c)}}}function Rn(i,t,e,n,r){return e=e!==void 0?e:!0,function(o,s,a,l){if(o!==void 0){let u=n?_n(i,n,a,r):i;return!e||!l?P(o,t,u):xn(o,u,t)}}}function hr(i){if(i!==void 0)return 0}function yn(i){if(i!==void 0)return i}function fr(i){let t=2*Math.PI/i;return function(e,n){if(n)return e;if(e!==void 0)return e=Math.floor(e/t+.5)*t,e}}function gr(i){let t=i===void 0?Vt(5):i;return function(e,n){return n||e===void 0?e:Math.abs(e)<=t?0:e}}function En(i){return Math.pow(i,3)}function dr(i){return 1-En(1-i)}function mr(i){return 3*i*i-2*i*i*i}var Ga=new Array(6);function ie(){return[1,0,0,1,0,0]}function J(i,t){let e=t[0],n=t[1];return t[0]=i[0]*e+i[2]*n+i[4],t[1]=i[1]*e+i[3]*n+i[5],t}function jt(i,t,e,n,r,o,s,a){let l=Math.sin(o),u=Math.cos(o);return i[0]=n*u,i[1]=r*l,i[2]=-n*l,i[3]=r*u,i[4]=s*n*u-a*n*l+t,i[5]=s*r*l+a*r*u+e,i}function _r(i,t){let e=Ko(t);v(e!==0,"Transformation matrix cannot be inverted");let n=t[0],r=t[1],o=t[2],s=t[3],a=t[4],l=t[5];return i[0]=s/e,i[1]=-r/e,i[2]=-o/e,i[3]=n/e,i[4]=(o*l-s*a)/e,i[5]=-(n*l-r*a)/e,i}function Ko(i){return i[0]*i[3]-i[1]*i[2]}var pr=[1e6,1e6,1e6,1e6,2,2];function xr(i){return"matrix("+i.map((e,n)=>Math.round(e*pr[n])/pr[n]).join(", ")+")"}function Tn(i,t,e,n,r,o){o=o||[];let s=0;for(let a=t;a<e;a+=n){let l=i[a],u=i[a+1];o[s++]=r[0]*l+r[2]*u+r[4],o[s++]=r[1]*l+r[3]*u+r[5]}return o&&o.length!=s&&(o.length=s),o}function Rr(i,t,e,n,r,o,s){s=s||[];let a=Math.cos(r),l=Math.sin(r),u=o[0],c=o[1],h=0;for(let f=t;f<e;f+=n){let d=i[f]-u,g=i[f+1]-c;s[h++]=u+d*a-g*l,s[h++]=c+d*l+g*a;for(let m=f+2;m<f+n;++m)s[h++]=i[m]}return s&&s.length!=h&&(s.length=h),s}function yr(i,t,e,n,r,o,s,a){a=a||[];let l=s[0],u=s[1],c=0;for(let h=t;h<e;h+=n){let f=i[h]-l,d=i[h+1]-u;a[c++]=l+r*f,a[c++]=u+o*d;for(let g=h+2;g<h+n;++g)a[c++]=i[g]}return a&&a.length!=c&&(a.length=c),a}function Er(i,t,e,n,r,o,s){s=s||[];let a=0;for(let l=t;l<e;l+=n){s[a++]=i[l]+r,s[a++]=i[l+1]+o;for(let u=l+2;u<l+n;++u)s[a++]=i[u]}return s&&s.length!=a&&(s.length=a),s}var Tr=ie(),Cn=class extends Mt{constructor(){super(),this.extent_=H(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=Si((t,e,n)=>{if(!n)return this.getSimplifiedGeometry(e);let r=this.clone();return r.applyTransform(n),r.getSimplifiedGeometry(e)})}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return I()}closestPointXY(t,e,n,r){return I()}containsXY(t,e){let n=this.getClosestPoint([t,e]);return n[0]===t&&n[1]===e}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return I()}getExtent(t){if(this.extentRevision_!=this.getRevision()){let e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&pe(e),this.extentRevision_=this.getRevision()}return Bi(this.extent_,t)}rotate(t,e){I()}scale(t,e,n){I()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return I()}getType(){return I()}applyTransform(t){I()}intersectsExtent(t){return I()}translate(t,e){I()}transform(t,e){let n=G(t),r=n.getUnits()=="tile-pixels"?function(o,s,a){let l=n.getExtent(),u=n.getWorldExtent(),c=L(u)/L(l);return jt(Tr,u[0],u[3],c,-c,0,0,0),Tn(o,0,o.length,a,Tr,s),Dt(n,e)(o,s,a)}:Dt(n,e);return this.applyTransform(r),this}},Cr=Cn;var Mn=class extends Cr{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(t){return ki(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return I()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;let e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=Mr(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){I()}setLayout(t,e,n){let r;if(t)r=Mr(t);else{for(let o=0;o<n;++o){if(e.length===0){this.layout="XY",this.stride=2;return}e=e[0]}r=e.length,t=qo(r)}this.layout=t,this.stride=r}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}rotate(t,e){let n=this.getFlatCoordinates();if(n){let r=this.getStride();Rr(n,0,n.length,r,t,e,n),this.changed()}}scale(t,e,n){e===void 0&&(e=t),n||(n=pt(this.getExtent()));let r=this.getFlatCoordinates();if(r){let o=this.getStride();yr(r,0,r.length,o,t,e,n,r),this.changed()}}translate(t,e){let n=this.getFlatCoordinates();if(n){let r=this.getStride();Er(n,0,n.length,r,t,e,n),this.changed()}}};function qo(i){let t;return i==2?t="XY":i==3?t="XYZ":i==4&&(t="XYZM"),t}function Mr(i){let t;return i=="XY"?t=2:i=="XYZ"||i=="XYM"?t=3:i=="XYZM"&&(t=4),t}var re=Mn;function Ir(i,t,e,n,r,o,s){let a=i[t],l=i[t+1],u=i[e]-a,c=i[e+1]-l,h;if(u===0&&c===0)h=t;else{let f=((r-a)*u+(o-l)*c)/(u*u+c*c);if(f>1)h=e;else if(f>0){for(let d=0;d<n;++d)s[d]=bi(i[t+d],i[e+d],f);s.length=n;return}else h=t}for(let f=0;f<n;++f)s[f]=i[h+f];s.length=n}function In(i,t,e,n,r){let o=i[t],s=i[t+1];for(t+=n;t<e;t+=n){let a=i[t],l=i[t+1],u=ht(o,s,a,l);u>r&&(r=u),o=a,s=l}return r}function wr(i,t,e,n,r){for(let o=0,s=e.length;o<s;++o){let a=e[o];r=In(i,t,a,n,r),t=a}return r}function wn(i,t,e,n,r,o,s,a,l,u,c){if(t==e)return u;let h,f;if(r===0){if(f=ht(s,a,i[t],i[t+1]),f<u){for(h=0;h<n;++h)l[h]=i[t+h];return l.length=n,f}return u}c=c||[NaN,NaN];let d=t+n;for(;d<e;)if(Ir(i,d-n,d,n,s,a,c),f=ht(s,a,c[0],c[1]),f<u){for(u=f,h=0;h<n;++h)l[h]=c[h];l.length=n,d+=n}else d+=n*Math.max((Math.sqrt(f)-Math.sqrt(u))/r|0,1);if(o&&(Ir(i,e-n,t,n,s,a,c),f=ht(s,a,c[0],c[1]),f<u)){for(u=f,h=0;h<n;++h)l[h]=c[h];l.length=n}return u}function vr(i,t,e,n,r,o,s,a,l,u,c){c=c||[NaN,NaN];for(let h=0,f=e.length;h<f;++h){let d=e[h];u=wn(i,t,d,n,r,o,s,a,l,u,c),t=d}return u}function Sr(i,t,e,n){for(let r=0,o=e.length;r<o;++r)i[t++]=e[r];return t}function vn(i,t,e,n){for(let r=0,o=e.length;r<o;++r){let s=e[r];for(let a=0;a<n;++a)i[t++]=s[a]}return t}function Pr(i,t,e,n,r){r=r||[];let o=0;for(let s=0,a=e.length;s<a;++s){let l=vn(i,t,e[s],n);r[o++]=l,t=l}return r.length=o,r}function Ar(i,t,e,n,r,o,s){let a=(e-t)/n;if(a<3){for(;t<e;t+=n)o[s++]=i[t],o[s++]=i[t+1];return s}let l=new Array(a);l[0]=1,l[a-1]=1;let u=[t,e-n],c=0;for(;u.length>0;){let h=u.pop(),f=u.pop(),d=0,g=i[f],m=i[f+1],p=i[h],x=i[h+1];for(let _=f+n;_<h;_+=n){let R=i[_],y=i[_+1],T=Ai(R,y,g,m,p,x);T>d&&(c=_,d=T)}d>r&&(l[(c-t)/n]=1,f+n<c&&u.push(f,c),c+n<h&&u.push(c,h))}for(let h=0;h<a;++h)l[h]&&(o[s++]=i[t+h*n],o[s++]=i[t+h*n+1]);return s}function oe(i,t){return t*Math.round(i/t)}function Vo(i,t,e,n,r,o,s){if(t==e)return s;let a=oe(i[t],r),l=oe(i[t+1],r);t+=n,o[s++]=a,o[s++]=l;let u,c;do if(u=oe(i[t],r),c=oe(i[t+1],r),t+=n,t==e)return o[s++]=u,o[s++]=c,s;while(u==a&&c==l);for(;t<e;){let h=oe(i[t],r),f=oe(i[t+1],r);if(t+=n,h==u&&f==c)continue;let d=u-a,g=c-l,m=h-a,p=f-l;if(d*p==g*m&&(d<0&&m<d||d==m||d>0&&m>d)&&(g<0&&p<g||g==p||g>0&&p>g)){u=h,c=f;continue}o[s++]=u,o[s++]=c,a=u,l=c,u=h,c=f}return o[s++]=u,o[s++]=c,s}function Fr(i,t,e,n,r,o,s,a){for(let l=0,u=e.length;l<u;++l){let c=e[l];s=Vo(i,t,c,n,r,o,s),a.push(s),t=c}return s}function Sn(i,t,e,n,r){r=r!==void 0?r:[];let o=0;for(let s=t;s<e;s+=n)r[o++]=i.slice(s,s+n);return r.length=o,r}function br(i,t,e,n,r){r=r!==void 0?r:[];let o=0;for(let s=0,a=e.length;s<a;++s){let l=e[s];r[o++]=Sn(i,t,l,n,r[o]),t=l}return r.length=o,r}function Pn(i,t,e,n){let r=0,o=i[e-n],s=i[e-n+1];for(;t<e;t+=n){let a=i[t],l=i[t+1];r+=s*a-o*l,o=a,s=l}return r/2}function Or(i,t,e,n){let r=0;for(let o=0,s=e.length;o<s;++o){let a=e[o];r+=Pn(i,t,a,n),t=a}return r}var An=class i extends re{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}clone(){return new i(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,n,r){return r<be(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(In(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),wn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,n,r))}getArea(){return Pn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Sn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){let e=[];return e.length=Ar(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new i(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=vn(this.flatCoordinates,0,t,this.stride),this.changed()}},Fn=An;var bn=class i extends re{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){let t=new i(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,r){let o=this.flatCoordinates,s=ht(t,e,o[0],o[1]);if(s<r){let a=this.stride;for(let l=0;l<a;++l)n[l]=o[l];return n.length=a,s}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return Yi(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return ln(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Sr(this.flatCoordinates,0,t,this.stride),this.changed()}},Lr=bn;function Xr(i,t,e,n,r){return!Oe(r,function(s){return!Pt(i,t,e,n,s[0],s[1])})}function Pt(i,t,e,n,r,o){let s=0,a=i[e-n],l=i[e-n+1];for(;t<e;t+=n){let u=i[t],c=i[t+1];l<=o?c>o&&(u-a)*(o-l)-(r-a)*(c-l)>0&&s++:c<=o&&(u-a)*(o-l)-(r-a)*(c-l)<0&&s--,a=u,l=c}return s!==0}function De(i,t,e,n,r,o){if(e.length===0||!Pt(i,t,e[0],n,r,o))return!1;for(let s=1,a=e.length;s<a;++s)if(Pt(i,e[s-1],e[s],n,r,o))return!1;return!0}function Nr(i,t,e,n,r,o,s){let a,l,u,c,h,f,d,g=r[o+1],m=[];for(let _=0,R=e.length;_<R;++_){let y=e[_];for(c=i[y-n],f=i[y-n+1],a=t;a<y;a+=n)h=i[a],d=i[a+1],(g<=f&&d<=g||f<=g&&g<=d)&&(u=(g-f)/(d-f)*(h-c)+c,m.push(u)),c=h,f=d}let p=NaN,x=-1/0;for(m.sort(ce),c=m[0],a=1,l=m.length;a<l;++a){h=m[a];let _=Math.abs(h-c);_>x&&(u=(c+h)/2,De(i,t,e,n,u,g)&&(p=u,x=_)),c=h}return isNaN(p)&&(p=r[o]),s?(s.push(p,g,x),s):[p,g,x]}function Dr(i,t,e,n,r){let o;for(t+=n;t<e;t+=n)if(o=r(i.slice(t-n,t),i.slice(t,t+n)),o)return o;return!1}function jr(i,t,e,n,r){let o=un(H(),i,t,e,n);return _t(r,o)?Zi(r,o)||o[0]>=r[0]&&o[2]<=r[2]||o[1]>=r[1]&&o[3]<=r[3]?!0:Dr(i,t,e,n,function(s,a){return Hi(r,s,a)}):!1}function On(i,t,e,n,r){return!!(jr(i,t,e,n,r)||Pt(i,t,e,n,r[0],r[1])||Pt(i,t,e,n,r[0],r[3])||Pt(i,t,e,n,r[2],r[1])||Pt(i,t,e,n,r[2],r[3]))}function Gr(i,t,e,n,r){if(!On(i,t,e[0],n,r))return!1;if(e.length===1)return!0;for(let o=1,s=e.length;o<s;++o)if(Xr(i,e[o-1],e[o],n,r)&&!jr(i,e[o-1],e[o],n,r))return!1;return!0}function zr(i,t,e,n){for(;t<e-n;){for(let r=0;r<n;++r){let o=i[t+r];i[t+r]=i[e-n+r],i[e-n+r]=o}t+=n,e-=n}}function Ur(i,t,e,n){let r=0,o=i[e-n],s=i[e-n+1];for(;t<e;t+=n){let a=i[t],l=i[t+1];r+=(a-o)*(l+s),o=a,s=l}return r===0?void 0:r>0}function Zr(i,t,e,n,r){r=r!==void 0?r:!1;for(let o=0,s=e.length;o<s;++o){let a=e[o],l=Ur(i,t,a,n);if(o===0){if(r&&l||!r&&!l)return!1}else if(r&&!l||!r&&l)return!1;t=a}return!0}function Ln(i,t,e,n,r){r=r!==void 0?r:!1;for(let o=0,s=e.length;o<s;++o){let a=e[o],l=Ur(i,t,a,n);(o===0?r&&l||!r&&!l:r&&!l||!r&&l)&&zr(i,t,a,n),t=a}return t}var Xn=class i extends re{constructor(t,e,n){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,e!==void 0&&n?(this.setFlatCoordinates(e,t),this.ends_=n):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?wi(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){let t=new i(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,n,r){return r<be(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(wr(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),vr(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,n,r))}containsXY(t,e){return De(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return Or(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),Ln(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,br(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){let t=pt(this.getExtent());this.flatInteriorPoint_=Nr(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new Lr(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new Fn(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){let t=this.layout,e=this.flatCoordinates,n=this.ends_,r=[],o=0;for(let s=0,a=n.length;s<a;++s){let l=n[s],u=new Fn(e.slice(o,l),t);r.push(u),o=l}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){let t=this.flatCoordinates;Zr(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Ln(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){let e=[],n=[];return e.length=Fr(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,n),new i(e,"XY",n)}getType(){return"Polygon"}intersectsExtent(t){return Gr(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);let n=Pr(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=n.length===0?0:n[n.length-1],this.changed()}};function Nn(i){if(ne(i))throw new Error("Cannot create polygon from empty extent");let t=i[0],e=i[1],n=i[2],r=i[3],o=[t,e,t,r,n,r,n,e,t,e];return new Xn(o,"XY",[o.length])}var Dn=0,Gn=class extends Mt{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=Xe(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&ir(),t.center&&(t.center=Rt(t.center,this.projection_)),t.extent&&(t.extent=St(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){let e=Object.assign({},t);for(let a in B)delete e[a];this.setProperties(e,!0);let n=Ho(t);this.maxResolution_=n.maxResolution,this.minResolution_=n.minResolution,this.zoomFactor_=n.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=n.minZoom;let r=Bo(t),o=n.constraint,s=Qo(t);this.constraints_={center:r,resolution:o,rotation:s},this.setRotation(t.rotation!==void 0?t.rotation:0),this.setCenterInternal(t.center!==void 0?t.center:null),t.resolution!==void 0?this.setResolution(t.resolution):t.zoom!==void 0&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;let n=this.getCenterInternal();if(n){let r=t||[0,0,0,0];e=e||[0,0,0,0];let o=this.getResolution(),s=o/2*(r[3]-e[3]+e[1]-r[1]),a=o/2*(r[0]-e[0]+e[2]-r[2]);this.setCenterInternal([n[0]+s,n[1]-a])}}getUpdatedOptions_(t){let e=this.getProperties();return e.resolution!==void 0?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);let e=new Array(arguments.length);for(let n=0;n<e.length;++n){let r=arguments[n];r.center&&(r=Object.assign({},r),r.center=Rt(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=Rt(r.anchor,this.getProjection())),e[n]=r}this.animateInternal.apply(this,e)}animateInternal(t){let e=arguments.length,n;e>1&&typeof arguments[e-1]=="function"&&(n=arguments[e-1],--e);let r=0;for(;r<e&&!this.isDef();++r){let c=arguments[r];c.center&&this.setCenterInternal(c.center),c.zoom!==void 0?this.setZoom(c.zoom):c.resolution&&this.setResolution(c.resolution),c.rotation!==void 0&&this.setRotation(c.rotation)}if(r===e){n&&je(n,!0);return}let o=Date.now(),s=this.targetCenter_.slice(),a=this.targetResolution_,l=this.targetRotation_,u=[];for(;r<e;++r){let c=arguments[r],h={start:o,complete:!1,anchor:c.anchor,duration:c.duration!==void 0?c.duration:1e3,easing:c.easing||mr,callback:n};if(c.center&&(h.sourceCenter=s,h.targetCenter=c.center.slice(),s=h.targetCenter),c.zoom!==void 0?(h.sourceResolution=a,h.targetResolution=this.getResolutionForZoom(c.zoom),a=h.targetResolution):c.resolution&&(h.sourceResolution=a,h.targetResolution=c.resolution,a=h.targetResolution),c.rotation!==void 0){h.sourceRotation=l;let f=ft(c.rotation-l+Math.PI,2*Math.PI)-Math.PI;h.targetRotation=l+f,l=h.targetRotation}Jo(h)?h.complete=!0:o+=h.duration,u.push(h)}this.animations_.push(u),this.setHint(gt.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[gt.ANIMATING]>0}getInteracting(){return this.hints_[gt.INTERACTING]>0}cancelAnimations(){this.setHint(gt.ANIMATING,-this.hints_[gt.ANIMATING]);let t;for(let e=0,n=this.animations_.length;e<n;++e){let r=this.animations_[e];if(r[0].callback&&je(r[0].callback,!1),!t)for(let o=0,s=r.length;o<s;++o){let a=r[o];if(!a.complete){t=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;let t=Date.now(),e=!1;for(let n=this.animations_.length-1;n>=0;--n){let r=this.animations_[n],o=!0;for(let s=0,a=r.length;s<a;++s){let l=r[s];if(l.complete)continue;let u=t-l.start,c=l.duration>0?u/l.duration:1;c>=1?(l.complete=!0,c=1):o=!1;let h=l.easing(c);if(l.sourceCenter){let f=l.sourceCenter[0],d=l.sourceCenter[1],g=l.targetCenter[0],m=l.targetCenter[1];this.nextCenter_=l.targetCenter;let p=f+h*(g-f),x=d+h*(m-d);this.targetCenter_=[p,x]}if(l.sourceResolution&&l.targetResolution){let f=h===1?l.targetResolution:l.sourceResolution+h*(l.targetResolution-l.sourceResolution);if(l.anchor){let d=this.getViewportSize_(this.getRotation()),g=this.constraints_.resolution(f,0,d,!0);this.targetCenter_=this.calculateCenterZoom(g,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=f,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){let f=h===1?ft(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+h*(l.targetRotation-l.sourceRotation);if(l.anchor){let d=this.constraints_.rotation(f,!0);this.targetCenter_=this.calculateCenterRotate(d,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=f}if(this.applyTargetState_(!0),e=!0,!l.complete)break}if(o){this.animations_[n]=null,this.setHint(gt.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;let s=r[0].callback;s&&je(s,!0)}}this.animations_=this.animations_.filter(Boolean),e&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let n,r=this.getCenterInternal();return r!==void 0&&(n=[r[0]-e[0],r[1]-e[1]],$i(n,t-this.getRotation()),Ji(n,e)),n}calculateCenterZoom(t,e){let n,r=this.getCenterInternal(),o=this.getResolution();if(r!==void 0&&o!==void 0){let s=e[0]-t*(e[0]-r[0])/o,a=e[1]-t*(e[1]-r[1])/o;n=[s,a]}return n}getViewportSize_(t){let e=this.viewportSize_;if(t){let n=e[0],r=e[1];return[Math.abs(n*Math.cos(t))+Math.abs(r*Math.sin(t)),Math.abs(n*Math.sin(t))+Math.abs(r*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){let t=this.getCenterInternal();return t&&mn(t,this.getProjection())}getCenterInternal(){return this.get(B.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return t!==void 0?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){let e=this.calculateExtentInternal(t);return ar(e,this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();let e=this.getCenterInternal();v(e,"The view center is not defined");let n=this.getResolution();v(n!==void 0,"The view resolution is not defined");let r=this.getRotation();return v(r!==void 0,"The view rotation is not defined"),Vi(e,n,r,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(B.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(St(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();let n=A(t)/e[0],r=L(t)/e[1];return Math.max(n,r)}getResolutionForValueFunction(t){t=t||2;let e=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,r=Math.log(e/n)/Math.log(t);return function(o){return e/Math.pow(t,o*r)}}getRotation(){return this.get(B.ROTATION)}getValueForResolutionFunction(t){let e=Math.log(t||2),n=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,o=Math.log(n/r)/e;return function(s){return Math.log(n/s)/e/o}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t),n=this.padding_;return n&&(e=[e[0]-n[1]-n[3],e[1]-n[0]-n[2]]),e}getState(){let t=this.getProjection(),e=this.getResolution(),n=this.getRotation(),r=this.getCenterInternal(),o=this.padding_;if(o){let s=this.getViewportSizeMinusPadding_();r=jn(r,this.getViewportSize_(),[s[0]/2+o[3],s[1]/2+o[0]],e,n)}return{center:r.slice(0),projection:t!==void 0?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:n,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t,e=this.getResolution();return e!==void 0&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e=this.minZoom_||0,n,r;if(this.resolutions_){let o=Wt(this.resolutions_,t,1);e=o,n=this.resolutions_[o],o==this.resolutions_.length-1?r=2:r=n/this.resolutions_[o+1]}else n=this.maxResolution_,r=this.zoomFactor_;return e+Math.log(n/t)/Math.log(r)}getResolutionForZoom(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;let e=P(Math.floor(t),0,this.resolutions_.length-2),n=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(n,P(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let n;if(v(Array.isArray(t)||typeof t.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(t)){v(!ne(t),"Cannot fit empty extent provided as `geometry`");let r=St(t,this.getProjection());n=Nn(r)}else if(t.getType()==="Circle"){let r=St(t.getExtent(),this.getProjection());n=Nn(r),n.rotate(this.getRotation(),pt(r))}else{let r=sr();r?n=t.clone().transform(r,this.getProjection()):n=t}this.fitInternal(n,e)}rotatedExtentForGeometry(t){let e=this.getRotation(),n=Math.cos(e),r=Math.sin(-e),o=t.getFlatCoordinates(),s=t.getStride(),a=1/0,l=1/0,u=-1/0,c=-1/0;for(let h=0,f=o.length;h<f;h+=s){let d=o[h]*n-o[h+1]*r,g=o[h]*r+o[h+1]*n;a=Math.min(a,d),l=Math.min(l,g),u=Math.max(u,d),c=Math.max(c,g)}return[a,l,u,c]}fitInternal(t,e){e=e||{};let n=e.size;n||(n=this.getViewportSizeMinusPadding_());let r=e.padding!==void 0?e.padding:[0,0,0,0],o=e.nearest!==void 0?e.nearest:!1,s;e.minResolution!==void 0?s=e.minResolution:e.maxZoom!==void 0?s=this.getResolutionForZoom(e.maxZoom):s=0;let a=this.rotatedExtentForGeometry(t),l=this.getResolutionForExtentInternal(a,[n[0]-r[1]-r[3],n[1]-r[0]-r[2]]);l=isNaN(l)?s:Math.max(l,s),l=this.getConstrainedResolution(l,o?0:1);let u=this.getRotation(),c=Math.sin(u),h=Math.cos(u),f=pt(a);f[0]+=(r[1]-r[3])/2*l,f[1]+=(r[0]-r[2])/2*l;let d=f[0]*h-f[1]*c,g=f[1]*h+f[0]*c,m=this.getConstrainedCenter([d,g],l),p=e.callback?e.callback:he;e.duration!==void 0?this.animateInternal({resolution:l,center:m,duration:e.duration,easing:e.easing},p):(this.targetResolution_=l,this.targetCenter_=m,this.applyTargetState_(!1,!0),je(p,!0))}centerOn(t,e,n){this.centerOnInternal(Rt(t,this.getProjection()),e,n)}centerOnInternal(t,e,n){this.setCenterInternal(jn(t,e,n,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,n,r){let o,s=this.padding_;if(s&&t){let a=this.getViewportSizeMinusPadding_(-n),l=jn(t,r,[a[0]/2+s[3],a[1]/2+s[0]],e,n);o=[t[0]-l[0],t[1]-l[1]]}return o}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(t){let e=mn(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){let e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&Rt(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){let n=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),o=this.constraints_.resolution(this.targetResolution_*t,0,r,n);e&&(this.targetCenter_=this.calculateCenterZoom(o,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=Rt(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){let n=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+t,n);e&&(this.targetCenter_=this.calculateCenterRotate(r,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t&&Rt(t,this.getProjection()))}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){let n=this.getAnimating()||this.getInteracting()||e,r=this.constraints_.rotation(this.targetRotation_,n),o=this.getViewportSize_(r),s=this.constraints_.resolution(this.targetResolution_,0,o,n),a=this.constraints_.center(this.targetCenter_,s,o,n,this.calculateCenterShift(this.targetCenter_,s,r,o));this.get(B.ROTATION)!==r&&this.set(B.ROTATION,r),this.get(B.RESOLUTION)!==s&&(this.set(B.RESOLUTION,s),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(B.CENTER)||!Nt(this.get(B.CENTER),a))&&this.set(B.CENTER,a),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,n){t=t!==void 0?t:200;let r=e||0,o=this.constraints_.rotation(this.targetRotation_),s=this.getViewportSize_(o),a=this.constraints_.resolution(this.targetResolution_,r,s),l=this.constraints_.center(this.targetCenter_,a,s,!1,this.calculateCenterShift(this.targetCenter_,a,o,s));if(t===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=o,this.targetCenter_=l,this.applyTargetState_();return}n=n||(t===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==o||!this.getCenterInternal()||!Nt(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:o,center:l,resolution:a,duration:t,easing:dr,anchor:n}))}beginInteraction(){this.resolveConstraints(0),this.setHint(gt.INTERACTING,1)}endInteraction(t,e,n){n=n&&Rt(n,this.getProjection()),this.endInteractionInternal(t,e,n)}endInteractionInternal(t,e,n){this.getInteracting()&&(this.setHint(gt.INTERACTING,-1),this.resolveConstraints(t,e,n))}getConstrainedCenter(t,e){let n=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),n)}getConstrainedZoom(t,e){let n=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(n,e))}getConstrainedResolution(t,e){e=e||0;let n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,n)}};function je(i,t){setTimeout(function(){i(t)},0)}function Bo(i){if(i.extent!==void 0){let e=i.smoothExtentConstraint!==void 0?i.smoothExtentConstraint:!0;return pn(i.extent,i.constrainOnlyCenter,e)}let t=Xe(i.projection,"EPSG:3857");if(i.multiWorld!==!0&&t.isGlobal()){let e=t.getExtent().slice();return e[0]=-1/0,e[2]=1/0,pn(e,!1,!1)}return lr}function Ho(i){let t,e,n,s=i.minZoom!==void 0?i.minZoom:Dn,a=i.maxZoom!==void 0?i.maxZoom:28,l=i.zoomFactor!==void 0?i.zoomFactor:2,u=i.multiWorld!==void 0?i.multiWorld:!1,c=i.smoothResolutionConstraint!==void 0?i.smoothResolutionConstraint:!0,h=i.showFullExtent!==void 0?i.showFullExtent:!1,f=Xe(i.projection,"EPSG:3857"),d=f.getExtent(),g=i.constrainOnlyCenter,m=i.extent;if(!u&&!m&&f.isGlobal()&&(g=!1,m=d),i.resolutions!==void 0){let p=i.resolutions;e=p[s],n=p[a]!==void 0?p[a]:p[p.length-1],i.constrainResolution?t=ur(p,c,!g&&m,h):t=Rn(e,n,c,!g&&m,h)}else{let x=(d?Math.max(A(d),L(d)):360*dt.degrees/f.getMetersPerUnit())/256/Math.pow(2,Dn),_=x/Math.pow(2,28-Dn);e=i.maxResolution,e!==void 0?s=0:e=x/Math.pow(l,s),n=i.minResolution,n===void 0&&(i.maxZoom!==void 0?i.maxResolution!==void 0?n=e/Math.pow(l,a):n=x/Math.pow(l,a):n=_),a=s+Math.floor(Math.log(e/n)/Math.log(l)),n=e/Math.pow(l,a-s),i.constrainResolution?t=cr(l,e,n,c,!g&&m,h):t=Rn(e,n,c,!g&&m,h)}return{constraint:t,maxResolution:e,minResolution:n,minZoom:s,zoomFactor:l}}function Qo(i){if(i.enableRotation!==void 0?i.enableRotation:!0){let e=i.constrainRotation;return e===void 0||e===!0?gr():e===!1?yn:typeof e=="number"?fr(e):yn}return hr}function Jo(i){return!(i.sourceCenter&&i.targetCenter&&!Nt(i.sourceCenter,i.targetCenter)||i.sourceResolution!==i.targetResolution||i.sourceRotation!==i.targetRotation)}function jn(i,t,e,n,r){let o=Math.cos(-r),s=Math.sin(-r),a=i[0]*o-i[1]*s,l=i[1]*o+i[0]*s;a+=(t[0]/2-e[0])*n,l+=(e[1]-t[1]/2)*n,s=-s;let u=a*o-l*s,c=l*o+a*s;return[u,c]}var zn=Gn;var Un=class extends Li{constructor(t){let e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(C.SOURCE,this.handleSourcePropertyChange_);let n=t.source?t.source:null;this.setSource(n)}getLayersArray(t){return t=t||[],t.push(this),t}getLayerStatesArray(t){return t=t||[],t.push(this.getLayerState()),t}getSource(){return this.get(C.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){let t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(V(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;let t=this.getSource();t&&(this.sourceChangeKey_=rt(t,X.CHANGE,this.handleSourceChange_,this),t.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return!this.renderer_||!this.rendered?null:this.renderer_.getData(t)}isVisible(t){let e,n=this.getMapInternal();!t&&n&&(t=n.getView()),t instanceof zn?e={viewState:t.getState(),extent:t.calculateExtent()}:e=t,!e.layerStatesArray&&n&&(e.layerStatesArray=n.getLayerGroup().getLayerStatesArray());let r;e.layerStatesArray?r=e.layerStatesArray.find(s=>s.layer===this):r=this.getLayerState();let o=this.getExtent();return $o(r,e.viewState)&&(!o||_t(o,e.extent))}getAttributions(t){if(!this.isVisible(t))return[];let e,n=this.getSource();if(n&&(e=n.getAttributions()),!e)return[];let r=t instanceof zn?t.getViewStateAndExtent():t,o=e(r);return Array.isArray(o)||(o=[o]),o}render(t,e){let n=this.getRenderer();return n.prepareFrame(t)?(this.rendered=!0,n.renderFrame(t,e)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(t,e){}renderDeferred(t){let e=this.getRenderer();e&&e.renderDeferred(t)}setMapInternal(t){t||this.unrender(),this.set(C.MAP,t)}getMapInternal(){return this.get(C.MAP)}setMap(t){this.mapPrecomposeKey_&&(V(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(V(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=rt(t,Xt.PRECOMPOSE,function(e){let r=e.frameState.layerStatesArray,o=this.getLayerState(!1);v(!r.some(function(s){return s.layer===o.layer}),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),r.push(o)},this),this.mapRenderKey_=rt(this,X.CHANGE,t.render,t),this.changed())}setSource(t){this.set(C.SOURCE,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}disposeInternal(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),super.disposeInternal()}};function $o(i,t){if(!i.visible)return!1;let e=t.resolution;if(e<i.minResolution||e>=i.maxResolution)return!1;let n=t.zoom;return n>i.minZoom&&n<=i.maxZoom}var kr=Un;var Re={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};var Zn=class extends kr{constructor(t){t=t||{};let e=Object.assign({},t);delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.setPreload(t.preload!==void 0?t.preload:0),this.setUseInterimTilesOnError(t.useInterimTilesOnError!==void 0?t.useInterimTilesOnError:!0)}getPreload(){return this.get(Re.PRELOAD)}setPreload(t){this.set(Re.PRELOAD,t)}getUseInterimTilesOnError(){return this.get(Re.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(t){this.set(Re.USE_INTERIM_TILES_ON_ERROR,t)}getData(t){return super.getData(t)}},Wr=Zn;var Gt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};var Yn=class extends Se{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.declutterExecutorGroup=null}getFeatures(t){return I()}getData(t){return null}prepareFrame(t){return I()}renderFrame(t,e){return I()}loadedTileCallback(t,e,n){t[e]||(t[e]={}),t[e][n.tileCoord.toString()]=n}createLoadedTileFinder(t,e,n){return(r,o)=>{let s=this.loadedTileCallback.bind(this,n,r);return t.forEachLoadedTile(e,r,o,s)}}forEachFeatureAtCoordinate(t,e,n,r,o){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){let e=t.target;(e.getState()===Gt.LOADED||e.getState()===Gt.ERROR)&&this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return e!=Gt.LOADED&&e!=Gt.ERROR&&t.addEventListener(X.CHANGE,this.boundHandleImageChange_),e==Gt.IDLE&&(t.load(),e=t.getState()),e==Gt.LOADED}renderIfReadyAndVisible(){let t=this.getLayer();t&&t.getVisible()&&t.getSourceState()==="ready"&&t.changed()}renderDeferred(t){}disposeInternal(){delete this.layer_,super.disposeInternal()}},Kr=Yn;var kn=class extends Ct{constructor(t,e,n,r){super(t),this.inversePixelTransform=e,this.frameState=n,this.context=r}},qr=kn;var At=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",bu=At.includes("firefox"),ts=At.includes("safari")&&!At.includes("chrom"),Ou=ts&&(At.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(At)),Lu=At.includes("webkit")&&!At.includes("edge"),Xu=At.includes("macintosh");var Vr=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,Br=typeof Image<"u"&&Image.prototype.decode;var Nu=function(){let i=!1;try{let t=Object.defineProperty({},"passive",{get:function(){i=!0}});window.addEventListener("_",null,t),window.removeEventListener("_",null,t)}catch{}return i}();function ot(i,t,e,n){let r;return e&&e.length?r=e.shift():Vr?r=new OffscreenCanvas(i||300,t||300):r=document.createElement("canvas"),i&&(r.width=i),t&&(r.height=t),r.getContext("2d",n)}var Wn;function Hr(){return Wn||(Wn=ot(1,1)),Wn}function ye(i){let t=i.canvas;t.width=1,t.height=1,i.clearRect(0,0,1,1)}var Kn=class{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(CanvasRenderingContext2D.prototype,{get:(t,e)=>{if(typeof Hr()[e]=="function")return this.instructions_[this.zIndex+this.offset_]||(this.instructions_[this.zIndex+this.offset_]=[]),this.instructions_[this.zIndex+this.offset_].push(e),this.pushMethodArgs_},set:(t,e,n)=>(this.instructions_[this.zIndex+this.offset_]||(this.instructions_[this.zIndex+this.offset_]=[]),this.instructions_[this.zIndex+this.offset_].push(e,n),!0)})}pushMethodArgs_=(...t)=>(this.instructions_[this.zIndex+this.offset_].push(t),this);getContext(){return this.context_}draw(t){this.instructions_.forEach(e=>{for(let n=0,r=e.length;n<r;n+=2){let o=e[n],s=e[n+1];if(typeof t[o]=="function")t[o](...s);else{if(typeof s=="function"){t[o]=s(t);continue}t[o]=s}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}},Qr=Kn;var Ft={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]};var zt={name:"xyz",min:[0,0,0],channel:["X","Y","Z"],alias:["XYZ","ciexyz","cie1931"]};zt.whitepoint={2:{A:[109.85,100,35.585],C:[98.074,100,118.232],D50:[96.422,100,82.521],D55:[95.682,100,92.149],D65:[95.045592705167,100,108.9057750759878],D75:[94.972,100,122.638],F2:[99.187,100,67.395],F7:[95.044,100,108.755],F11:[100.966,100,64.37],E:[100,100,100]},10:{A:[111.144,100,35.2],C:[97.285,100,116.145],D50:[96.72,100,81.427],D55:[95.799,100,90.926],D65:[94.811,100,107.304],D75:[94.416,100,120.641],F2:[103.28,100,69.026],F7:[95.792,100,107.687],F11:[103.866,100,65.627],E:[100,100,100]}};zt.max=zt.whitepoint[2].D65;zt.rgb=function(i,t){t=t||zt.whitepoint[2].E;var e=i[0]/t[0],n=i[1]/t[1],r=i[2]/t[2],o,s,a;return o=e*3.240969941904521+n*-1.537383177570093+r*-.498610760293,s=e*-.96924363628087+n*1.87596750150772+r*.041555057407175,a=e*.055630079696993+n*-.20397695888897+r*1.056971514242878,o=o>.0031308?1.055*Math.pow(o,1/2.4)-.055:o=o*12.92,s=s>.0031308?1.055*Math.pow(s,1/2.4)-.055:s=s*12.92,a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:a=a*12.92,o=Math.min(Math.max(0,o),1),s=Math.min(Math.max(0,s),1),a=Math.min(Math.max(0,a),1),[o*255,s*255,a*255]};Ft.xyz=function(i,t){var e=i[0]/255,n=i[1]/255,r=i[2]/255;e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92,r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92;var o=e*.41239079926595+n*.35758433938387+r*.18048078840183,s=e*.21263900587151+n*.71516867876775+r*.072192315360733,a=e*.019330818715591+n*.11919477979462+r*.95053215224966;return t=t||zt.whitepoint[2].E,[o*t[0],s*t[1],a*t[2]]};var $=zt;var qn={name:"luv",min:[0,-134,-140],max:[100,224,122],channel:["lightness","u","v"],alias:["LUV","cieluv","cie1976"],xyz:function(i,t,e){var n,r,o,s,a,l,u,c,h,f,d,g,m;if(o=i[0],s=i[1],a=i[2],o===0)return[0,0,0];var p=.0011070564598794539;return t=t||"D65",e=e||2,h=$.whitepoint[e][t][0],f=$.whitepoint[e][t][1],d=$.whitepoint[e][t][2],g=4*h/(h+15*f+3*d),m=9*f/(h+15*f+3*d),n=s/(13*o)+g||0,r=a/(13*o)+m||0,u=o>8?f*Math.pow((o+16)/116,3):f*o*p,l=u*9*n/(4*r)||0,c=u*(12-3*n-20*r)/(4*r)||0,[l,u,c]}};$.luv=function(i,t,e){var n,r,o,s,a,l,u,c,h,f,d,g,m,p=.008856451679035631,x=903.2962962962961;t=t||"D65",e=e||2,h=$.whitepoint[e][t][0],f=$.whitepoint[e][t][1],d=$.whitepoint[e][t][2],g=4*h/(h+15*f+3*d),m=9*f/(h+15*f+3*d),l=i[0],u=i[1],c=i[2],n=4*l/(l+15*u+3*c)||0,r=9*u/(l+15*u+3*c)||0;var _=u/f;return o=_<=p?x*_:116*Math.pow(_,1/3)-16,s=13*o*(n-g),a=13*o*(r-m),[o,s,a]};qn.lchuv=function(i){var t=i[0],e=i[1],n=i[2],r=Math.sqrt(e*e+n*n),o=Math.atan2(n,e),s=o*360/2/Math.PI;return s<0&&(s+=360),[t,r,s]};$.lchuv=function(i){return qn.lchuv($.luv(i))};var Vn={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};var $r=es,Jr={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function es(i){var t,e=[],n=1,r;if(typeof i=="number")return{space:"rgb",values:[i>>>16,(i&65280)>>>8,i&255],alpha:1};if(typeof i=="number")return{space:"rgb",values:[i>>>16,(i&65280)>>>8,i&255],alpha:1};if(i=String(i).toLowerCase(),Vn[i])e=Vn[i].slice(),r="rgb";else if(i==="transparent")n=0,r="rgb",e=[0,0,0];else if(i[0]==="#"){var o=i.slice(1),s=o.length,a=s<=4;n=1,a?(e=[parseInt(o[0]+o[0],16),parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16)],s===4&&(n=parseInt(o[3]+o[3],16)/255)):(e=[parseInt(o[0]+o[1],16),parseInt(o[2]+o[3],16),parseInt(o[4]+o[5],16)],s===8&&(n=parseInt(o[6]+o[7],16)/255)),e[0]||(e[0]=0),e[1]||(e[1]=0),e[2]||(e[2]=0),r="rgb"}else if(t=/^((?:rgba?|hs[lvb]a?|hwba?|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms|oklch|oklab|color))\s*\(([^\)]*)\)/.exec(i)){var l=t[1];r=l.replace(/a$/,"");var u=r==="cmyk"?4:r==="gray"?1:3;e=t[2].trim().split(/\s*[,\/]\s*|\s+/),r==="color"&&(r=e.shift()),e=e.map(function(c,h){if(c[c.length-1]==="%")return c=parseFloat(c)/100,h===3?c:r==="rgb"?c*255:r[0]==="h"||r[0]==="l"&&!h?c*100:r==="lab"?c*125:r==="lch"?h<2?c*150:c*360:r[0]==="o"&&!h?c:r==="oklab"?c*.4:r==="oklch"?h<2?c*.4:c*360:c;if(r[h]==="h"||h===2&&r[r.length-1]==="h"){if(Jr[c]!==void 0)return Jr[c];if(c.endsWith("deg"))return parseFloat(c);if(c.endsWith("turn"))return parseFloat(c)*360;if(c.endsWith("grad"))return parseFloat(c)*360/400;if(c.endsWith("rad"))return parseFloat(c)*180/Math.PI}return c==="none"?0:parseFloat(c)}),n=e.length>u?e.pop():1}else/[0-9](?:\s|\/|,)/.test(i)&&(e=i.match(/([0-9]+)/g).map(function(c){return parseFloat(c)}),r=i.match(/([a-z])/ig)?.join("")?.toLowerCase()||"rgb");return{space:r,values:e,alpha:n}}var Ge={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(i){var t=i[0]/360,e=i[1]/100,n=i[2]/100,r,o,s,a,l,u=0;if(e===0)return l=n*255,[l,l,l];for(o=n<.5?n*(1+e):n+e-n*e,r=2*n-o,a=[0,0,0];u<3;)s=t+1/3*-(u-1),s<0?s++:s>1&&s--,l=6*s<1?r+(o-r)*6*s:2*s<1?o:3*s<2?r+(o-r)*(2/3-s)*6:r,a[u++]=l*255;return a}};Ft.hsl=function(i){var t=i[0]/255,e=i[1]/255,n=i[2]/255,r=Math.min(t,e,n),o=Math.max(t,e,n),s=o-r,a,l,u;return o===r?a=0:t===o?a=(e-n)/s:e===o?a=2+(n-t)/s:n===o&&(a=4+(t-e)/s),a=Math.min(a*60,360),a<0&&(a+=360),u=(r+o)/2,o===r?l=0:u<=.5?l=s/(o+r):l=s/(2-o-r),[a,l*100,u*100]};function Bn(i){Array.isArray(i)&&i.raw&&(i=String.raw(...arguments)),i instanceof Number&&(i=+i);var t,e,n,r=$r(i);if(!r.space)return[];let o=r.space[0]==="h"?Ge.min:Ft.min,s=r.space[0]==="h"?Ge.max:Ft.max;return t=Array(3),t[0]=Math.min(Math.max(r.values[0],o[0]),s[0]),t[1]=Math.min(Math.max(r.values[1],o[1]),s[1]),t[2]=Math.min(Math.max(r.values[2],o[2]),s[2]),r.space[0]==="h"&&(t=Ge.rgb(t)),t.push(Math.min(Math.max(r.alpha,0),1)),t}var ns=1024,Ee={},Hn=0;function is(i){if(Ee.hasOwnProperty(i))return Ee[i];if(Hn>=ns){let e=0;for(let n in Ee)e++&3||(delete Ee[n],--Hn)}let t=Bn(i);if(t.length!==4)throw new Error('Failed to parse "'+i+'" as color');for(let e of t)if(isNaN(e))throw new Error('Failed to parse "'+i+'" as color');return rs(t),Ee[i]=t,++Hn,t}function Qn(i){return Array.isArray(i)?i:is(i)}function rs(i){return i[0]=P(i[0]+.5|0,0,255),i[1]=P(i[1]+.5|0,0,255),i[2]=P(i[2]+.5|0,0,255),i[3]=P(i[3],0,1),i}var se=null;function os(){se=ot(1,1,void 0,{willReadFrequently:!0})}var Jn=class extends Kr{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=ie(),this.pixelTransform=ie(),this.inversePixelTransform=ie(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.pixelContext_=null,this.frameState=null}getImageData(t,e,n){se||os(),se.clearRect(0,0,1,1);let r;try{se.drawImage(t,e,n,1,1,0,0,1,1),r=se.getImageData(0,0,1,1).data}catch{return se=null,null}return r}getBackground(t){let n=this.getLayer().getBackground();return typeof n=="function"&&(n=n(t.viewState.resolution)),n||void 0}useContainer(t,e,n){let r=this.getLayer().getClassName(),o,s;if(t&&t.className===r&&(!n||t&&t.style.backgroundColor&&Ie(Qn(t.style.backgroundColor),Qn(n)))){let a=t.firstElementChild;a instanceof HTMLCanvasElement&&(s=a.getContext("2d"))}if(s&&s.canvas.style.transform===e?(this.container=t,this.context=s,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){o=document.createElement("div"),o.className=r;let a=o.style;a.position="absolute",a.width="100%",a.height="100%",s=ot();let l=s.canvas;o.appendChild(l),a=l.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=o,this.context=s}!this.containerReused&&n&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=n)}clipUnrotated(t,e,n){let r=Q(n),o=ee(n),s=$t(n),a=Jt(n);J(e.coordinateToPixelTransform,r),J(e.coordinateToPixelTransform,o),J(e.coordinateToPixelTransform,s),J(e.coordinateToPixelTransform,a);let l=this.inversePixelTransform;J(l,r),J(l,o),J(l,s),J(l,a),t.save(),t.beginPath(),t.moveTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.clip()}dispatchRenderEvent_(t,e,n){let r=this.getLayer();if(r.hasListener(t)){let o=new qr(t,this.inversePixelTransform,n,e);r.dispatchEvent(o)}}preRender(t,e){this.frameState=e,!e.declutter&&this.dispatchRenderEvent_(Xt.PRERENDER,t,e)}postRender(t,e){e.declutter||this.dispatchRenderEvent_(Xt.POSTRENDER,t,e)}renderDeferredInternal(t){}getRenderContext(t){return t.declutter&&!this.deferredContext_&&(this.deferredContext_=new Qr),t.declutter?this.deferredContext_.getContext():this.context}renderDeferred(t){t.declutter&&(this.dispatchRenderEvent_(Xt.PRERENDER,this.context,t),t.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(t),this.dispatchRenderEvent_(Xt.POSTRENDER,this.context,t))}getRenderTransform(t,e,n,r,o,s,a){let l=o/2,u=s/2,c=r/e,h=-c,f=-t[0]+a,d=-t[1];return jt(this.tempTransform,l,u,c,h,-n,f,d)}disposeInternal(){delete this.frameState,super.disposeInternal()}},to=Jn;var E={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};var $n=class extends ve{constructor(t,e,n){super(),n=n||{},this.tileCoord=t,this.state=e,this.interimTile=null,this.key="",this.transition_=n.transition===void 0?250:n.transition,this.transitionStarts_={},this.interpolate=!!n.interpolate}changed(){this.dispatchEvent(X.CHANGE)}release(){this.state===E.ERROR&&this.setState(E.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getInterimTile(){let t=this.interimTile;if(!t)return this;do{if(t.getState()==E.LOADED)return this.transition_=0,t;t=t.interimTile}while(t);return this}refreshInterimChain(){let t=this.interimTile;if(!t)return;let e=this;do{if(t.getState()==E.LOADED){t.interimTile=null;break}t.getState()==E.LOADING?e=t:t.getState()==E.IDLE?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(this.state!==E.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}load(){I()}getAlpha(t,e){if(!this.transition_)return 1;let n=this.transitionStarts_[t];if(!n)n=e,this.transitionStarts_[t]=n;else if(n===-1)return 1;let r=e-n+1e3/60;return r>=this.transition_?1:En(r/this.transition_)}inTransition(t){return this.transition_?this.transitionStarts_[t]!==-1:!1}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}},ze=$n;function eo(i,t,e){let n=i,r=!0,o=!1,s=!1,a=[Kt(n,X.LOAD,function(){s=!0,o||t()})];return n.src&&Br?(o=!0,n.decode().then(function(){r&&t()}).catch(function(l){r&&(s?t():e())})):a.push(Kt(n,X.ERROR,e)),function(){r=!1,a.forEach(V)}}var ti=class extends ze{constructor(t,e,n,r,o,s){super(t,e,s),this.crossOrigin_=r,this.src_=n,this.key=n,this.image_=new Image,r!==null&&(this.image_.crossOrigin=r),this.unlisten_=null,this.tileLoadFunction_=o}getImage(){return this.image_}setImage(t){this.image_=t,this.state=E.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=E.ERROR,this.unlistenImage_(),this.image_=ss(),this.changed()}handleImageLoad_(){let t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=E.LOADED:this.state=E.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==E.ERROR&&(this.state=E.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==E.IDLE&&(this.state=E.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=eo(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}};function ss(){let i=ot(1,1);return i.fillStyle="rgba(0,0,0,0)",i.fillRect(0,0,1,1),i.canvas}var Ue=ti;var as=10,no=.25,ei=class{constructor(t,e,n,r,o,s){this.sourceProj_=t,this.targetProj_=e;let a={},l=Dt(this.targetProj_,this.sourceProj_);this.transformInv_=function(_){let R=_[0]+"/"+_[1];return a[R]||(a[R]=l(_)),a[R]},this.maxSourceExtent_=r,this.errorThresholdSquared_=o*o,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&A(r)>=A(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?A(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?A(this.targetProj_.getExtent()):null;let u=Q(n),c=ee(n),h=$t(n),f=Jt(n),d=this.transformInv_(u),g=this.transformInv_(c),m=this.transformInv_(h),p=this.transformInv_(f),x=as+(s?Math.max(0,Math.ceil(Math.log2(xe(n)/(s*s*256*256)))):0);if(this.addQuad_(u,c,h,f,d,g,m,p,x),this.wrapsXInSource_){let _=1/0;this.triangles_.forEach(function(R,y,T){_=Math.min(_,R.source[0][0],R.source[1][0],R.source[2][0])}),this.triangles_.forEach(R=>{if(Math.max(R.source[0][0],R.source[1][0],R.source[2][0])-_>this.sourceWorldWidth_/2){let y=[[R.source[0][0],R.source[0][1]],[R.source[1][0],R.source[1][1]],[R.source[2][0],R.source[2][1]]];y[0][0]-_>this.sourceWorldWidth_/2&&(y[0][0]-=this.sourceWorldWidth_),y[1][0]-_>this.sourceWorldWidth_/2&&(y[1][0]-=this.sourceWorldWidth_),y[2][0]-_>this.sourceWorldWidth_/2&&(y[2][0]-=this.sourceWorldWidth_);let T=Math.min(y[0][0],y[1][0],y[2][0]);Math.max(y[0][0],y[1][0],y[2][0])-T<this.sourceWorldWidth_/2&&(R.source=y)}})}a={}}addTriangle_(t,e,n,r,o,s){this.triangles_.push({source:[r,o,s],target:[t,e,n]})}addQuad_(t,e,n,r,o,s,a,l,u){let c=an([o,s,a,l]),h=this.sourceWorldWidth_?A(c)/this.sourceWorldWidth_:null,f=this.sourceWorldWidth_,d=this.sourceProj_.canWrapX()&&h>.5&&h<1,g=!1;if(u>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){let p=an([t,e,n,r]);g=A(p)/this.targetWorldWidth_>no||g}!d&&this.sourceProj_.isGlobal()&&h&&(g=h>no||g)}if(!g&&this.maxSourceExtent_&&isFinite(c[0])&&isFinite(c[1])&&isFinite(c[2])&&isFinite(c[3])&&!_t(c,this.maxSourceExtent_))return;let m=0;if(!g&&(!isFinite(o[0])||!isFinite(o[1])||!isFinite(s[0])||!isFinite(s[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(l[0])||!isFinite(l[1]))){if(u>0)g=!0;else if(m=(!isFinite(o[0])||!isFinite(o[1])?8:0)+(!isFinite(s[0])||!isFinite(s[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),m!=1&&m!=2&&m!=4&&m!=8)return}if(u>0){if(!g){let p=[(t[0]+n[0])/2,(t[1]+n[1])/2],x=this.transformInv_(p),_;d?_=(ft(o[0],f)+ft(a[0],f))/2-ft(x[0],f):_=(o[0]+a[0])/2-x[0];let R=(o[1]+a[1])/2-x[1];g=_*_+R*R>this.errorThresholdSquared_}if(g){if(Math.abs(t[0]-n[0])<=Math.abs(t[1]-n[1])){let p=[(e[0]+n[0])/2,(e[1]+n[1])/2],x=this.transformInv_(p),_=[(r[0]+t[0])/2,(r[1]+t[1])/2],R=this.transformInv_(_);this.addQuad_(t,e,p,_,o,s,x,R,u-1),this.addQuad_(_,p,n,r,R,x,a,l,u-1)}else{let p=[(t[0]+e[0])/2,(t[1]+e[1])/2],x=this.transformInv_(p),_=[(n[0]+r[0])/2,(n[1]+r[1])/2],R=this.transformInv_(_);this.addQuad_(t,p,_,r,o,x,R,l,u-1),this.addQuad_(p,e,n,_,x,s,a,R,u-1)}return}}if(d){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}m&11||this.addTriangle_(t,n,r,o,a,l),m&14||this.addTriangle_(t,n,e,o,a,s),m&&(m&13||this.addTriangle_(e,r,t,s,l,o),m&7||this.addTriangle_(e,r,n,s,l,a))}calculateSourceExtent(){let t=H();return this.triangles_.forEach(function(e,n,r){let o=e.source;_e(t,o[0]),_e(t,o[1]),_e(t,o[2])}),t}getTriangles(){return this.triangles_}},io=ei;var ni,Ut=[];function ro(i,t,e,n,r){i.beginPath(),i.moveTo(0,0),i.lineTo(t,e),i.lineTo(n,r),i.closePath(),i.save(),i.clip(),i.fillRect(0,0,Math.max(t,n)+1,Math.max(e,r)),i.restore()}function ii(i,t){return Math.abs(i[t*4]-210)>2||Math.abs(i[t*4+3]-.75*255)>2}function ls(){if(ni===void 0){let i=ot(6,6,Ut);i.globalCompositeOperation="lighter",i.fillStyle="rgba(210, 0, 0, 0.75)",ro(i,4,5,4,0),ro(i,4,5,0,5);let t=i.getImageData(0,0,3,3).data;ni=ii(t,0)||ii(t,4)||ii(t,8),ye(i),Ut.push(i.canvas)}return ni}function oo(i,t,e,n){let r=Ne(e,t,i),o=gn(t,n,e),s=t.getMetersPerUnit();s!==void 0&&(o*=s);let a=i.getMetersPerUnit();a!==void 0&&(o/=a);let l=i.getExtent();if(!l||Qt(l,r)){let u=gn(i,o,r)/o;isFinite(u)&&u>0&&(o/=u)}return o}function so(i,t,e,n){let r=pt(e),o=oo(i,t,r,n);return(!isFinite(o)||o<=0)&&Oe(e,function(s){return o=oo(i,t,s,n),isFinite(o)&&o>0}),o}function ao(i,t,e,n,r,o,s,a,l,u,c,h,f,d){let g=ot(Math.round(e*i),Math.round(e*t),Ut);if(h||(g.imageSmoothingEnabled=!1),l.length===0)return g.canvas;g.scale(e,e);function m(T){return Math.round(T*e)/e}g.globalCompositeOperation="lighter";let p=H();l.forEach(function(T,S,Y){Ki(p,T.extent)});let x,_=e/n,R=(h?1:1+Math.pow(2,-24))/_;if(!f||l.length!==1||u!==0){if(x=ot(Math.round(A(p)*_),Math.round(L(p)*_),Ut),h||(x.imageSmoothingEnabled=!1),r&&d){let T=(r[0]-p[0])*_,S=-(r[3]-p[3])*_,Y=A(r)*_,M=L(r)*_;x.rect(T,S,Y,M),x.clip()}l.forEach(function(T,S,Y){let M=(T.extent[0]-p[0])*_,F=-(T.extent[3]-p[3])*_,U=A(T.extent)*_,nt=L(T.extent)*_;T.image.width>0&&T.image.height>0&&x.drawImage(T.image,u,u,T.image.width-2*u,T.image.height-2*u,h?M:Math.round(M),h?F:Math.round(F),h?U:Math.round(M+U)-Math.round(M),h?nt:Math.round(F+nt)-Math.round(F))})}let y=Q(s);return a.getTriangles().forEach(function(T,S,Y){let M=T.source,F=T.target,U=M[0][0],nt=M[0][1],yt=M[1][0],Et=M[1][1],Ot=M[2][0],Tt=M[2][1],st=m((F[0][0]-y[0])/o),w=m(-(F[0][1]-y[1])/o),Z=m((F[1][0]-y[0])/o),k=m(-(F[1][1]-y[1])/o),it=m((F[2][0]-y[0])/o),Lt=m(-(F[2][1]-y[1])/o),z=U,W=nt;U=0,nt=0,yt-=z,Et-=W,Ot-=z,Tt-=W;let N=[[yt,Et,0,0,Z-st],[Ot,Tt,0,0,it-st],[0,0,yt,Et,k-w],[0,0,Ot,Tt,Lt-w]],b=Fi(N);if(!b)return;if(g.save(),g.beginPath(),ls()||!h){g.moveTo(Z,k);let D=4,K=st-Z,lt=w-k;for(let et=0;et<D;et++)g.lineTo(Z+m((et+1)*K/D),k+m(et*lt/(D-1))),et!=D-1&&g.lineTo(Z+m((et+1)*K/D),k+m((et+1)*lt/(D-1)));g.lineTo(it,Lt)}else g.moveTo(Z,k),g.lineTo(st,w),g.lineTo(it,Lt);g.clip(),g.transform(b[0],b[2],b[1],b[3],st,w),g.translate(p[0]-z,p[3]-W);let at;if(x)at=x.canvas,g.scale(R,-R);else{let D=l[0],K=D.extent;at=D.image,g.scale(A(K)/at.width,-L(K)/at.height)}g.drawImage(at,0,0),g.restore()}),x&&(ye(x),Ut.push(x.canvas)),c&&(g.save(),g.globalCompositeOperation="source-over",g.strokeStyle="black",g.lineWidth=1,a.getTriangles().forEach(function(T,S,Y){let M=T.target,F=(M[0][0]-y[0])/o,U=-(M[0][1]-y[1])/o,nt=(M[1][0]-y[0])/o,yt=-(M[1][1]-y[1])/o,Et=(M[2][0]-y[0])/o,Ot=-(M[2][1]-y[1])/o;g.beginPath(),g.moveTo(nt,yt),g.lineTo(F,U),g.lineTo(Et,Ot),g.closePath(),g.stroke()}),g.restore()),g.canvas}var ri=class extends ze{constructor(t,e,n,r,o,s,a,l,u,c,h,f){super(o,E.IDLE,f),this.renderEdges_=h!==void 0?h:!1,this.pixelRatio_=a,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=r,this.wrappedTileCoord_=s||o,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;let d=r.getTileCoordExtent(this.wrappedTileCoord_),g=this.targetTileGrid_.getExtent(),m=this.sourceTileGrid_.getExtent(),p=g?te(d,g):d;if(xe(p)===0){this.state=E.EMPTY;return}let x=t.getExtent();x&&(m?m=te(m,x):m=x);let _=r.getResolution(this.wrappedTileCoord_[0]),R=so(t,n,p,_);if(!isFinite(R)||R<=0){this.state=E.EMPTY;return}let y=c!==void 0?c:.5;if(this.triangulation_=new io(t,n,p,m,R*y,_),this.triangulation_.getTriangles().length===0){this.state=E.EMPTY;return}this.sourceZ_=e.getZForResolution(R);let T=this.triangulation_.calculateSourceExtent();if(m&&(t.canWrapX()?(T[1]=P(T[1],m[1],m[3]),T[3]=P(T[3],m[1],m[3])):T=te(T,m)),!xe(T))this.state=E.EMPTY;else{let S=e.getTileRangeForExtentAndZ(T,this.sourceZ_);for(let Y=S.minX;Y<=S.maxX;Y++)for(let M=S.minY;M<=S.maxY;M++){let F=u(this.sourceZ_,Y,M,a);F&&this.sourceTiles_.push(F)}this.sourceTiles_.length===0&&(this.state=E.EMPTY)}}getImage(){return this.canvas_}reproject_(){let t=[];if(this.sourceTiles_.forEach(e=>{e&&e.getState()==E.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})}),this.sourceTiles_.length=0,t.length===0)this.state=E.ERROR;else{let e=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(e),r=typeof n=="number"?n:n[0],o=typeof n=="number"?n:n[1],s=this.targetTileGrid_.getResolution(e),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=ao(r,o,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),s,l,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=E.LOADED}this.changed()}load(){if(this.state==E.IDLE){this.state=E.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(e=>{let n=e.getState();if(n==E.IDLE||n==E.LOADING){t++;let r=rt(e,X.CHANGE,function(o){let s=e.getState();(s==E.LOADED||s==E.ERROR||s==E.EMPTY)&&(V(r),t--,t===0&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(r)}}),t===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(e,n,r){e.getState()==E.IDLE&&e.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(V),this.sourcesListenerKeys_=null}release(){this.canvas_&&(ye(this.canvas_.getContext("2d")),Ut.push(this.canvas_),this.canvas_=null),super.release()}},Te=ri;var Ze=class{constructor(t,e,n,r){this.minX=t,this.maxX=e,this.minY=n,this.maxY=r}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}};function Zt(i,t,e,n,r){return r!==void 0?(r.minX=i,r.maxX=t,r.minY=e,r.maxY=n,r):new Ze(i,t,e,n)}var Ye=Ze;function lo(i,t,e){return e===void 0&&(e=[0,0]),e[0]=i[0]*t+.5|0,e[1]=i[1]*t+.5|0,e}function tt(i,t){return Array.isArray(i)?i:(t===void 0?t=[i,i]:(t[0]=i,t[1]=i),t)}var oi=class extends to{constructor(t){super(t),this.extentChanged=!0,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=H(),this.tmpTileRange_=new Ye(0,0,0,0)}isDrawableTile(t){let e=this.getLayer(),n=t.getState(),r=e.getUseInterimTilesOnError();return n==E.LOADED||n==E.EMPTY||n==E.ERROR&&!r}getTile(t,e,n,r){let o=r.pixelRatio,s=r.viewState.projection,a=this.getLayer(),u=a.getSource().getTile(t,e,n,o,s);return u.getState()==E.ERROR&&a.getUseInterimTilesOnError()&&a.getPreload()>0&&(this.newTiles_=!0),this.isDrawableTile(u)||(u=u.getInterimTile()),u}getData(t){let e=this.frameState;if(!e)return null;let n=this.getLayer(),r=J(e.pixelToCoordinateTransform,t.slice()),o=n.getExtent();if(o&&!Qt(o,r))return null;let s=e.pixelRatio,a=e.viewState.projection,l=e.viewState,u=n.getRenderSource(),c=u.getTileGridForProjection(l.projection),h=u.getTilePixelRatio(e.pixelRatio);for(let f=c.getZForResolution(l.resolution);f>=c.getMinZoom();--f){let d=c.getTileCoordForCoordAndZ(r,f),g=u.getTile(f,d[1],d[2],s,a);if(!(g instanceof Ue||g instanceof Te)||g instanceof Te&&g.getState()===E.EMPTY)return null;if(g.getState()!==E.LOADED)continue;let m=c.getOrigin(f),p=tt(c.getTileSize(f)),x=c.getResolution(f),_=Math.floor(h*((r[0]-m[0])/x-d[1]*p[0])),R=Math.floor(h*((m[1]-r[1])/x-d[2]*p[1])),y=Math.round(h*u.getGutterForProjection(l.projection));return this.getImageData(g.getImage(),_+y,R+y)}return null}loadedTileCallback(t,e,n){return this.isDrawableTile(n)?super.loadedTileCallback(t,e,n):!1}prepareFrame(t){return!!this.getLayer().getSource()}renderFrame(t,e){let n=t.layerStatesArray[t.layerIndex],r=t.viewState,o=r.projection,s=r.resolution,a=r.center,l=r.rotation,u=t.pixelRatio,c=this.getLayer(),h=c.getSource(),f=h.getRevision(),d=h.getTileGridForProjection(o),g=d.getZForResolution(s,h.zDirection),m=d.getResolution(g),p=t.extent,x=t.viewState.resolution,_=h.getTilePixelRatio(u),R=Math.round(A(p)/x*u),y=Math.round(L(p)/x*u),T=n.extent&&St(n.extent,o);T&&(p=te(p,St(n.extent,o)));let S=m*R/2/_,Y=m*y/2/_,M=[a[0]-S,a[1]-Y,a[0]+S,a[1]+Y],F=d.getTileRangeForExtentAndZ(p,g),U={};U[g]={};let nt=this.createLoadedTileFinder(h,o,U),yt=this.tmpExtent,Et=this.tmpTileRange_;this.newTiles_=!1;let Ot=l?Le(r.center,x,l,t.size):void 0;for(let W=F.minX;W<=F.maxX;++W)for(let N=F.minY;N<=F.maxY;++N){if(l&&!d.tileCoordIntersectsViewport([g,W,N],Ot))continue;let b=this.getTile(g,W,N,t);if(this.isDrawableTile(b)){let K=j(this);if(b.getState()==E.LOADED){U[g][b.tileCoord.toString()]=b;let lt=b.inTransition(K);lt&&n.opacity!==1&&(b.endTransition(K),lt=!1),!this.newTiles_&&(lt||!this.renderedTiles.includes(b))&&(this.newTiles_=!0)}if(b.getAlpha(K,t.time)===1)continue}let at=d.getTileCoordChildTileRange(b.tileCoord,Et,yt),D=!1;at&&(D=nt(g+1,at)),D||d.forEachTileCoordParentTileRange(b.tileCoord,nt,Et,yt)}let Tt=m/s*u/_;jt(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/u,1/u,l,-R/2,-y/2);let st=xr(this.pixelTransform);this.useContainer(e,st,this.getBackground(t));let w=this.getRenderContext(t),Z=this.context.canvas;_r(this.inversePixelTransform,this.pixelTransform),jt(this.tempTransform,R/2,y/2,Tt,Tt,0,-R/2,-y/2),Z.width!=R||Z.height!=y?(Z.width=R,Z.height=y):this.containerReused||w.clearRect(0,0,R,y),T&&this.clipUnrotated(w,t,T),h.getInterpolate()||(w.imageSmoothingEnabled=!1),this.preRender(w,t),this.renderedTiles.length=0;let k=Object.keys(U).map(Number);k.sort(ce);let it,Lt,z;n.opacity===1&&(!this.containerReused||h.getOpaque(t.viewState.projection))?k=k.reverse():(it=[],Lt=[]);for(let W=k.length-1;W>=0;--W){let N=k[W],b=h.getTilePixelSize(N,u,o),D=d.getResolution(N)/m,K=b[0]*D*Tt,lt=b[1]*D*Tt,et=d.getTileCoordForCoordAndZ(Q(M),N),_i=d.getTileCoordExtent(et),Ce=J(this.tempTransform,[_*(_i[0]-M[0])/m,_*(M[3]-_i[3])/m]),vo=_*h.getGutterForProjection(o),xi=U[N];for(let So in xi){let kt=xi[So],Ri=kt.tileCoord,yi=et[1]-Ri[1],Po=Math.round(Ce[0]-(yi-1)*K),Ei=et[2]-Ri[2],Ao=Math.round(Ce[1]-(Ei-1)*lt),ut=Math.round(Ce[0]-yi*K),ct=Math.round(Ce[1]-Ei*lt),le=Po-ut,ue=Ao-ct,Ti=g===N,Ci=Ti&&kt.getAlpha(j(this),t.time)!==1,He=!1;if(!Ci)if(it){z=[ut,ct,ut+le,ct,ut+le,ct+ue,ut,ct+ue];for(let Me=0,Fo=it.length;Me<Fo;++Me)if(g!==N&&N<Lt[Me]){let q=it[Me];_t([ut,ct,ut+le,ct+ue],[q[0],q[3],q[4],q[7]])&&(He||(w.save(),He=!0),w.beginPath(),w.moveTo(z[0],z[1]),w.lineTo(z[2],z[3]),w.lineTo(z[4],z[5]),w.lineTo(z[6],z[7]),w.moveTo(q[6],q[7]),w.lineTo(q[4],q[5]),w.lineTo(q[2],q[3]),w.lineTo(q[0],q[1]),w.clip())}it.push(z),Lt.push(N)}else w.clearRect(ut,ct,le,ue);this.drawTileImage(kt,t,ut,ct,le,ue,vo,Ti),it&&!Ci?(He&&w.restore(),this.renderedTiles.unshift(kt)):this.renderedTiles.push(kt),this.updateUsedTiles(t.usedTiles,h,kt)}}return this.renderedRevision=f,this.renderedResolution=m,this.extentChanged=!this.renderedExtent_||!Wi(this.renderedExtent_,M),this.renderedExtent_=M,this.renderedPixelRatio=u,this.renderedProjection=o,this.manageTilePyramid(t,h,d,u,o,p,g,c.getPreload()),this.scheduleExpireCache(t,h),this.postRender(this.context,t),n.extent&&w.restore(),w.imageSmoothingEnabled=!0,st!==Z.style.transform&&(Z.style.transform=st),this.container}drawTileImage(t,e,n,r,o,s,a,l){let u=this.getTileImage(t);if(!u)return;let c=this.getRenderContext(e),h=j(this),f=e.layerStatesArray[e.layerIndex],d=f.opacity*(l?t.getAlpha(h,e.time):1),g=d!==c.globalAlpha;g&&(c.save(),c.globalAlpha=d),c.drawImage(u,a,a,u.width-2*a,u.height-2*a,n,r,o,s),g&&c.restore(),d!==f.opacity?e.animate=!0:l&&t.endTransition(h)}getImage(){let t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}scheduleExpireCache(t,e){if(e.canExpireCache()){let n=function(r,o,s){let a=j(r);a in s.usedTiles&&r.expireCache(s.viewState.projection,s.usedTiles[a])}.bind(null,e);t.postRenderFunctions.push(n)}}updateUsedTiles(t,e,n){let r=j(e);r in t||(t[r]={}),t[r][n.getKey()]=!0}manageTilePyramid(t,e,n,r,o,s,a,l,u){let c=j(e);c in t.wantedTiles||(t.wantedTiles[c]={});let h=t.wantedTiles[c],f=t.tileQueue,d=n.getMinZoom(),g=t.viewState.rotation,m=g?Le(t.viewState.center,t.viewState.resolution,g,t.size):void 0,p=0,x,_,R,y,T,S;for(S=d;S<=a;++S)for(_=n.getTileRangeForExtentAndZ(s,S,_),R=n.getResolution(S),y=_.minX;y<=_.maxX;++y)for(T=_.minY;T<=_.maxY;++T)g&&!n.tileCoordIntersectsViewport([S,y,T],m)||(a-S<=l?(++p,x=e.getTile(S,y,T,r,o),x.getState()==E.IDLE&&(h[x.getKey()]=!0,f.isKeyQueued(x.getKey())||f.enqueue([x,c,n.getTileCoordCenter(x.tileCoord),R])),u!==void 0&&u(x)):e.useTile(S,y,T,o));e.updateCacheSize(p,o)}},uo=oi;var si=class extends Wr{constructor(t){super(t)}createRenderer(){return new uo(this)}},co=si;var ai=class{constructor(t){this.highWaterMark=t!==void 0?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.pop()}clear(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){let n=this.entries_[t];return v(n!==void 0,"Tried to get a value for a key that does not exist in the cache"),n===this.newest_||(n===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(n.newer.older=n.older,n.older.newer=n.newer),n.newer=null,n.older=this.newest_,this.newest_.newer=n,this.newest_=n),n.value_}remove(t){let e=this.entries_[t];return v(e!==void 0,"Tried to get a value for a key that does not exist in the cache"),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){let t=new Array(this.count_),e=0,n;for(n=this.newest_;n;n=n.older)t[e++]=n.key_;return t}getValues(){let t=new Array(this.count_),e=0,n;for(n=this.newest_;n;n=n.older)t[e++]=n.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){return this.entries_[t]?.value_}pop(){let t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){v(!(t in this.entries_),"Tried to set a value for a key that is used already");let n={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[t]=n,++this.count_}setSize(t){this.highWaterMark=t}},ho=ai;function li(i,t,e,n){return n!==void 0?(n[0]=i,n[1]=t,n[2]=e,n):[i,t,e]}function Yt(i,t,e){return i+"/"+t+"/"+e}function ke(i){return Yt(i[0],i[1],i[2])}function fo(i){return i.split("/").map(Number)}function go(i){return(i[1]<<i[0])+i[2]}function mo(i,t){let e=i[0],n=i[1],r=i[2];if(t.getMinZoom()>e||e>t.getMaxZoom())return!1;let o=t.getFullTileRange(e);return o?o.containsXY(n,r):!0}var ui=class extends ho{clear(){for(;this.getCount()>0;)this.pop().release();super.clear()}expireCache(t){for(;this.canExpireCache()&&!(this.peekLast().getKey()in t);)this.pop().release()}pruneExceptNewestZ(){if(this.getCount()===0)return;let t=this.peekFirstKey(),n=fo(t)[0];this.forEach(r=>{r.tileCoord[0]!==n&&(this.remove(ke(r.tileCoord)),r.release())})}},We=ui;var Ke={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};var ci=class extends Mt{constructor(t){super(),this.projection=G(t.projection),this.attributions_=po(t.attributions),this.attributionsCollapsible_=t.attributionsCollapsible!==void 0?t.attributionsCollapsible:!0,this.loading=!1,this.state_=t.state!==void 0?t.state:"ready",this.wrapX_=t.wrapX!==void 0?t.wrapX:!1,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;let e=this;this.viewPromise_=new Promise(function(n,r){e.viewResolver=n,e.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(t){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=po(t),this.changed()}setState(t){this.state_=t,this.changed()}};function po(i){return i?Array.isArray(i)?function(t){return i}:typeof i=="function"?i:function(t){return[i]}:null}var _o=ci;var ae=[0,0,0],bt=5,hi=class{constructor(t){this.minZoom=t.minZoom!==void 0?t.minZoom:0,this.resolutions_=t.resolutions,v(vi(this.resolutions_,(r,o)=>o-r,!0),"`resolutions` must be sorted in descending order");let e;if(!t.origins){for(let r=0,o=this.resolutions_.length-1;r<o;++r)if(!e)e=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==e){e=void 0;break}}this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=t.origin!==void 0?t.origin:null,this.origins_=null,t.origins!==void 0&&(this.origins_=t.origins,v(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));let n=t.extent;n!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Q(n)),v(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,t.tileSizes!==void 0&&(this.tileSizes_=t.tileSizes,v(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=t.tileSize!==void 0?t.tileSize:this.tileSizes_?null:256,v(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=n!==void 0?n:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],t.sizes!==void 0?this.fullTileRanges_=t.sizes.map((r,o)=>{let s=new Ye(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(n){let a=this.getTileRangeForExtentAndZ(n,o);s.minX=Math.max(a.minX,s.minX),s.maxX=Math.min(a.maxX,s.maxX),s.minY=Math.max(a.minY,s.minY),s.maxY=Math.min(a.maxY,s.maxY)}return s}):n&&this.calculateTileRanges_(n)}forEachTileCoord(t,e,n){let r=this.getTileRangeForExtentAndZ(t,e);for(let o=r.minX,s=r.maxX;o<=s;++o)for(let a=r.minY,l=r.maxY;a<=l;++a)n([e,o,a])}forEachTileCoordParentTileRange(t,e,n,r){let o,s,a,l=null,u=t[0]-1;for(this.zoomFactor_===2?(s=t[1],a=t[2]):l=this.getTileCoordExtent(t,r);u>=this.minZoom;){if(s!==void 0&&a!==void 0?(s=Math.floor(s/2),a=Math.floor(a/2),o=Zt(s,s,a,a,n)):o=this.getTileRangeForExtentAndZ(l,u,n),e(u,o))return!0;--u}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_?this.origin_:this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,n){if(t[0]<this.maxZoom){if(this.zoomFactor_===2){let o=t[1]*2,s=t[2]*2;return Zt(o,o+1,s,s+1,e)}let r=this.getTileCoordExtent(t,n||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,n){if(e>this.maxZoom||e<this.minZoom)return null;let r=t[0],o=t[1],s=t[2];if(e===r)return Zt(o,s,o,s,n);if(this.zoomFactor_){let l=Math.pow(this.zoomFactor_,e-r),u=Math.floor(o*l),c=Math.floor(s*l);if(e<r)return Zt(u,u,c,c,n);let h=Math.floor(l*(o+1))-1,f=Math.floor(l*(s+1))-1;return Zt(u,h,c,f,n)}let a=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,e,n)}getTileRangeForExtentAndZ(t,e,n){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,ae);let r=ae[1],o=ae[2];this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,ae);let s=ae[1],a=ae[2];return Zt(r,s,o,a,n)}getTileCoordCenter(t){let e=this.getOrigin(t[0]),n=this.getResolution(t[0]),r=tt(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*r[0]*n,e[1]-(t[2]+.5)*r[1]*n]}getTileCoordExtent(t,e){let n=this.getOrigin(t[0]),r=this.getResolution(t[0]),o=tt(this.getTileSize(t[0]),this.tmpSize_),s=n[0]+t[1]*o[0]*r,a=n[1]-(t[2]+1)*o[1]*r,l=s+o[0]*r,u=a+o[1]*r;return wt(s,a,l,u,e)}getTileCoordForCoordAndResolution(t,e,n){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,n)}getTileCoordForXYAndResolution_(t,e,n,r,o){let s=this.getZForResolution(n),a=n/this.getResolution(s),l=this.getOrigin(s),u=tt(this.getTileSize(s),this.tmpSize_),c=a*(t-l[0])/n/u[0],h=a*(l[1]-e)/n/u[1];return r?(c=ge(c,bt)-1,h=ge(h,bt)-1):(c=fe(c,bt),h=fe(h,bt)),li(s,c,h,o)}getTileCoordForXYAndZ_(t,e,n,r,o){let s=this.getOrigin(n),a=this.getResolution(n),l=tt(this.getTileSize(n),this.tmpSize_),u=(t-s[0])/a/l[0],c=(s[1]-e)/a/l[1];return r?(u=ge(u,bt)-1,c=ge(c,bt)-1):(u=fe(u,bt),c=fe(c,bt)),li(n,u,c,o)}getTileCoordForCoordAndZ(t,e,n){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,n)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){let n=Wt(this.resolutions_,t,e||0);return P(n,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(t,e){return On(e,0,e.length,2,this.getTileCoordExtent(t))}calculateTileRanges_(t){let e=this.resolutions_.length,n=new Array(e);for(let r=this.minZoom;r<e;++r)n[r]=this.getTileRangeForExtentAndZ(t,r);this.fullTileRanges_=n}},fi=hi;function qe(i){let t=i.getDefaultTileGrid();return t||(t=cs(i),i.setDefaultTileGrid(t)),t}function xo(i,t,e){let n=t[0],r=i.getTileCoordCenter(t),o=Ve(e);if(!Qt(o,r)){let s=A(o),a=Math.ceil((o[0]-r[0])/s);return r[0]+=s*a,i.getTileCoordForCoordAndZ(r,n)}return t}function us(i,t,e,n){n=n!==void 0?n:"top-left";let r=yo(i,t,e);return new fi({extent:i,origin:qi(i,n),resolutions:r,tileSize:e})}function Ro(i){let t=i||{},e=t.extent||G("EPSG:3857").getExtent(),n={extent:e,minZoom:t.minZoom,tileSize:t.tileSize,resolutions:yo(e,t.maxZoom,t.tileSize,t.maxResolution)};return new fi(n)}function yo(i,t,e,n){t=t!==void 0?t:42,e=tt(e!==void 0?e:256);let r=L(i),o=A(i);n=n>0?n:Math.max(o/e[0],r/e[1]);let s=t+1,a=new Array(s);for(let l=0;l<s;++l)a[l]=n/Math.pow(2,l);return a}function cs(i,t,e,n){let r=Ve(i);return us(r,t,e,n)}function Ve(i){i=G(i);let t=i.getExtent();if(!t){let e=180*dt.degrees/i.getMetersPerUnit();t=wt(-e,-e,e,e)}return t}var gi=class extends _o{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.on,this.once,this.un,this.opaque_=t.opaque!==void 0?t.opaque:!1,this.tilePixelRatio_=t.tilePixelRatio!==void 0?t.tilePixelRatio:1,this.tileGrid=t.tileGrid!==void 0?t.tileGrid:null;let e=[256,256];this.tileGrid&&tt(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),e),this.tileCache=new We(t.cacheSize||0),this.tmpSize=[0,0],this.key_=t.key||"",this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection?t.zDirection:0}canExpireCache(){return this.tileCache.canExpireCache()}expireCache(t,e){let n=this.getTileCacheForProjection(t);n&&n.expireCache(e)}forEachLoadedTile(t,e,n,r){let o=this.getTileCacheForProjection(t);if(!o)return!1;let s=!0,a,l,u;for(let c=n.minX;c<=n.maxX;++c)for(let h=n.minY;h<=n.maxY;++h)l=Yt(e,c,h),u=!1,o.containsKey(l)&&(a=o.get(l),u=a.getState()===E.LOADED,u&&(u=r(a)!==!1)),u||(s=!1);return s}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getOpaque(t){return this.opaque_}getResolutions(t){let e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}getTile(t,e,n,r,o){return I()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid?this.tileGrid:qe(t)}getTileCacheForProjection(t){let e=this.getProjection();return v(e===null||vt(e,t),"A VectorTile source can only be rendered if it has a projection compatible with the view projection."),this.tileCache}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,n){let r=this.getTileGridForProjection(n),o=this.getTilePixelRatio(e),s=tt(r.getTileSize(t),this.tmpSize);return o==1?s:lo(s,o,this.tmpSize)}getTileCoordForTileUrlFunction(t,e){e=e!==void 0?e:this.getProjection();let n=this.getTileGridForProjection(e);return this.getWrapX()&&e.isGlobal()&&(t=xo(n,t,e)),mo(t,n)?t:null}clear(){this.tileCache.clear()}refresh(){this.clear(),super.refresh()}updateCacheSize(t,e){let n=this.getTileCacheForProjection(e);t>n.highWaterMark&&(n.highWaterMark=t)}useTile(t,e,n,r){}},Be=class extends Ct{constructor(t,e){super(t),this.tile=e}},Eo=gi;function hs(i,t){let e=/\{z\}/g,n=/\{x\}/g,r=/\{y\}/g,o=/\{-y\}/g;return function(s,a,l){if(s)return i.replace(e,s[0].toString()).replace(n,s[1].toString()).replace(r,s[2].toString()).replace(o,function(){let u=s[0],c=t.getFullTileRange(u);if(!c)throw new Error("The {-y} placeholder requires a tile grid with extent");return(c.getHeight()-s[2]-1).toString()})}}function To(i,t){let e=i.length,n=new Array(e);for(let r=0;r<e;++r)n[r]=hs(i[r],t);return fs(n)}function fs(i){return i.length===1?i[0]:function(t,e,n){if(!t)return;let r=go(t),o=ft(r,i.length);return i[o](t,e,n)}}function Co(i){let t=[],e=/\{([a-z])-([a-z])\}/.exec(i);if(e){let n=e[1].charCodeAt(0),r=e[2].charCodeAt(0),o;for(o=n;o<=r;++o)t.push(i.replace(e[0],String.fromCharCode(o)));return t}if(e=/\{(\d+)-(\d+)\}/.exec(i),e){let n=parseInt(e[2],10);for(let r=parseInt(e[1],10);r<=n;r++)t.push(i.replace(e[0],r.toString()));return t}return t.push(i),t}var di=class i extends Eo{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===i.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){let e=t.target,n=j(e),r=e.getState(),o;r==E.LOADING?(this.tileLoadingKeys_[n]=!0,o=Ke.TILELOADSTART):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],o=r==E.ERROR?Ke.TILELOADERROR:r==E.LOADED?Ke.TILELOADEND:void 0),o!=null&&this.dispatchEvent(new Be(o,e))}setTileLoadFunction(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),typeof e<"u"?this.setKey(e):this.changed()}setUrl(t){let e=Co(t);this.urls=e,this.setUrls(e)}setUrls(t){this.urls=t;let e=t.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(To(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,n){}useTile(t,e,n){let r=Yt(t,e,n);this.tileCache.containsKey(r)&&this.tileCache.get(r)}},Mo=di;var mi=class extends Mo{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:gs,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate!==void 0?t.interpolate:!0,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=t.crossOrigin!==void 0?t.crossOrigin:null,this.tileClass=t.tileClass!==void 0?t.tileClass:Ue,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}canExpireCache(){if(this.tileCache.canExpireCache())return!0;for(let t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1}expireCache(t,e){let n=this.getTileCacheForProjection(t);this.tileCache.expireCache(this.tileCache==n?e:{});for(let r in this.tileCacheForProjection){let o=this.tileCacheForProjection[r];o.expireCache(o==n?e:{})}}getGutterForProjection(t){return this.getProjection()&&t&&!vt(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getOpaque(t){return this.getProjection()&&t&&!vt(this.getProjection(),t)?!1:super.getOpaque(t)}getTileGridForProjection(t){let e=this.getProjection();if(this.tileGrid&&(!e||vt(e,t)))return this.tileGrid;let n=j(t);return n in this.tileGridForProjection||(this.tileGridForProjection[n]=qe(t)),this.tileGridForProjection[n]}getTileCacheForProjection(t){let e=this.getProjection();if(!e||vt(e,t))return this.tileCache;let n=j(t);return n in this.tileCacheForProjection||(this.tileCacheForProjection[n]=new We(this.tileCache.highWaterMark)),this.tileCacheForProjection[n]}createTile_(t,e,n,r,o,s){let a=[t,e,n],l=this.getTileCoordForTileUrlFunction(a,o),u=l?this.tileUrlFunction(l,r,o):void 0,c=new this.tileClass(a,u!==void 0?E.IDLE:E.EMPTY,u!==void 0?u:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return c.key=s,c.addEventListener(X.CHANGE,this.handleTileChange.bind(this)),c}getTile(t,e,n,r,o){let s=this.getProjection();if(!s||!o||vt(s,o))return this.getTileInternal(t,e,n,r,s||o);let a=this.getTileCacheForProjection(o),l=[t,e,n],u,c=ke(l);a.containsKey(c)&&(u=a.get(c));let h=this.getKey();if(u&&u.key==h)return u;let f=this.getTileGridForProjection(s),d=this.getTileGridForProjection(o),g=this.getTileCoordForTileUrlFunction(l,o),m=new Te(s,f,o,d,l,g,this.getTilePixelRatio(r),this.getGutter(),(p,x,_,R)=>this.getTileInternal(p,x,_,R,s),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return m.key=h,u?(m.interimTile=u,m.refreshInterimChain(),a.replace(c,m)):a.set(c,m),m}getTileInternal(t,e,n,r,o){let s=null,a=Yt(t,e,n),l=this.getKey();if(!this.tileCache.containsKey(a))s=this.createTile_(t,e,n,r,o,l),this.tileCache.set(a,s);else if(s=this.tileCache.get(a),s.key!=l){let u=s;s=this.createTile_(t,e,n,r,o,l),u.getState()==E.IDLE?s.interimTile=u.interimTile:s.interimTile=u,s.refreshInterimChain(),this.tileCache.replace(a,s)}return s}setRenderReprojectionEdges(t){if(this.renderReprojectionEdges_!=t){this.renderReprojectionEdges_=t;for(let e in this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}}setTileGridForProjection(t,e){let n=G(t);if(n){let r=j(n);r in this.tileGridForProjection||(this.tileGridForProjection[r]=e)}}clear(){super.clear();for(let t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear()}};function gs(i,t){i.getImage().src=t}var Io=mi;var pi=class extends Io{constructor(t){t=t||{};let e=t.projection!==void 0?t.projection:"EPSG:3857",n=t.tileGrid!==void 0?t.tileGrid:Ro({extent:Ve(e),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,opaque:t.opaque,projection:e,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:n,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX!==void 0?t.wrapX:!0,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.gutter_=t.gutter!==void 0?t.gutter:0}getGutter(){return this.gutter_}},wo=pi;function ds({model:i,el:t}){new_layer=co(source=wo(url="https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png"))}var Ff={render:ds};export{Ff as default};
